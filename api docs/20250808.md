## 2025-08-13 â€“ Admin elevate í…ŒìŠ¤íŠ¸/ë¬¸ì„œ ì •ë¦¬

ë³€ê²½ ìš”ì•½
- í”„ë¡œëª¨ í…ŒìŠ¤íŠ¸ ë³´ê°•: test_limited_packages_promos.pyì—ì„œ admin_lpromoë¥¼ /api/admin/users/elevateë¡œ ìŠ¹ê²©í•˜ì—¬ 403 skip ê°ì†Œ
- ë¬¸ì„œ ì •ë¦¬: 20250729-ê°€ì´ë“œ006.mdì˜ "ê´€ë¦¬ì ê¸°ëŠ¥" ê¸°ì¡´ ì„¹ì…˜ì— ì²´í¬ë°•ìŠ¤ ìƒíƒœ ë°˜ì˜(íšŒì› ê´€ë¦¬ API âœ…) ë° í•˜ë‹¨ ì¤‘ë³µ ì„ì…˜ ì œê±°

ê²€ì¦ ê²°ê³¼
- ëŒ€ìƒ í…ŒìŠ¤íŠ¸ ë¡œì»¬ ì‹¤í–‰ ì‹œ ê´€ë¦¬ì ìŠ¹ê²© í—ˆìš© í™˜ê²½ì—ì„œ SKIP â†’ PASS ì „í™˜ ê¸°ëŒ€, ê¶Œí•œ ê°€ë“œ ì°¨ë‹¨ í™˜ê²½ì—ì„œëŠ” ë°©ì–´ì  ìŠ¤í‚µ ìœ ì§€
- /docs ë…¸ì¶œ ì •ìƒ, ì¤‘ë³µ ê´€ë¦¬ì ì„¹ì…˜ ì œê±° í™•ì¸

ë‹¤ìŒ ë‹¨ê³„
- ì»¨í…Œì´ë„ˆ ë‚´ë¶€ pytest ì „ì²´ ì‹¤í–‰ ë° Alembic heads ë‹¨ì¼ ì¬í™•ì¸
- í”„ë¡œëª¨ max_uses/ê¸°ê°„/í™œì„± ìƒíƒœ ì—£ì§€ì¼€ì´ìŠ¤ ì¶”ê°€ TC ë³´ê°•
- í•„ìš” ì‹œ OpenAPI ì¬ìˆ˜ì¶œ ë° í”„ë¡ íŠ¸ AdminPanel ë°˜ì˜

## 2025-08-13 â€“ Admin Users API & Limited Packages Tests

ë³€ê²½ ìš”ì•½
- Admin Users API ì¶”ê°€: GET/PUT/DELETE /api/admin/users, /api/admin/users/{id} (ëª©ë¡/ì¡°íšŒ/ê°±ì‹ /ì‚­ì œ)
- require_admin_access ì¢…ì†ì„± ì •ì˜ë¥¼ ë¼ìš°í„° ìƒë‹¨ìœ¼ë¡œ ì´ë™í•˜ì—¬ import ì‹œ NameError ìˆ˜ì •
- í•œì • íŒ¨í‚¤ì§€ í…ŒìŠ¤íŠ¸ ë³´ê°•: per-user limit/ì¬ê³ /ê¸´ê¸‰ ë¹„í™œì„±í™” ì‹œë‚˜ë¦¬ì˜¤ ì¶”ê°€(ê´€ë¦¬ì ê°€ë“œ ì‹œ skip ì²˜ë¦¬)
- í”„ë¡œëª¨ ì½”ë“œ ì‚¬ìš©ëŸ‰ ì¦ê°€ ë¡œì§ ì¶”ê°€: í• ì¸ ì ìš© ì‹œ ShopPromoCode.used_count ì¦ê°€
- OpenAPI ì¬ìˆ˜ì¶œ ì™„ë£Œ: cc-webapp/backend/current_openapi.json ê°±ì‹ 

ê²€ì¦ ê²°ê³¼
- ì‹ ê·œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰: test_admin_users_api.py, test_limited_packages_promos.py â†’ SKIPPED(2) â€” ê´€ë¦¬ì ê°€ë“œ/ê¶Œí•œ ë¶€ì¬ ì‹œ í•©ë¦¬ì  ìŠ¤í‚µ
- ì¸ì¦ ìŠ¤ëª¨í¬(ë³„ë„ ì‹¤í–‰ ê¸°ë¡): PASS, Pydantic v2 ê²½ê³ ëŠ” ì”ì¡´(ì°¨í›„ ConfigDict ì´í–‰ ì˜ˆì •)
- /docs ë…¸ì¶œ ì •ìƒ, Admin/Shop/Limited ê²½ë¡œ ë°˜ì˜ í™•ì¸

ë‹¤ìŒ ë‹¨ê³„
- ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ì „ì²´ pytest ì‹¤í–‰ ë° Alembic heads ë‹¨ì¼ í™•ì¸(alembic heads)
- ê´€ë¦¬ì ì‹œë“œ/ê¶Œí•œ ë¶€ì—¬ í”Œë¡œìš° ë§ˆë ¨ í›„ Admin Users API E2E í†µê³¼ë¡œ ì „í™˜, í”„ë¡œëª¨ ì½”ë“œ ìƒì„±/ìµœëŒ€ ì‚¬ìš©ëŸ‰ ê²€ì¦ TC ì¶”ê°€
- OpenAPI íƒ€ì… ì¬ìƒì„±(ì„ íƒ) ë° í”„ë¡ íŠ¸ AdminPanel ì—°ë™ ì ê²€

## 2025-08-13 ì—…ë°ì´íŠ¸ (Shop & Economy)
\n+ë³€ê²½ ìš”ì•½ (Alembic ì •ë¦¬ & í•œì • íŒ¨í‚¤ì§€ í…Œì´ë¸”)
- Alembic ë‹¨ì¼ head ìœ ì§€ ì¬ì •ë¹„: ì¤‘ë³µ ëª©ì  ë¦¬ë¹„ì „ `20250813_add_shop_tables` ì œê±°, ì²´ì¸ì€ `20250813_user_actions_ix_type_created â†’ 20250813_create_shop_tables â†’ 20250813_add_limited_packages_and_promos`ë¡œ ë‹¨ì¼í™”
- ì‹ ê·œ í…Œì´ë¸” ì¶”ê°€: `shop_limited_packages`, `shop_promo_codes` (idempotent ìƒì„±, ì¸ë±ìŠ¤/ìœ ë‹ˆí¬ í¬í•¨)
- ëª¨ë¸ ì •í•©ì„±: `app.models.__init__`ì—ì„œ ShopLimitedPackage/ShopPromoCodeë¥¼ `shop_models`ë¡œë¶€í„° ë‚´ë³´ë‚´ë„ë¡ í†µì¼

ê²€ì¦ ê²°ê³¼
- pytest ìŠ¤ëª¨í¬(ì¸ì¦/ë¸”ë™ë¦¬ìŠ¤íŠ¸/ë¦¬í”„ë ˆì‹œ): PASS (12 + 3 ì¼€ì´ìŠ¤), Pydantic v2 ê²½ê³ ëŠ” ì”ì¡´(ì°¨í›„ ConfigDict ì´í–‰ ì˜ˆì •)
- Alembic ì²´ì¸ ì ê²€: heads ë‹¨ì¼ ìœ ì§€, down_revision ì—°ê²° ì •ìƒ
- í•œì • íŒ¨í‚¤ì§€ E2E í…ŒìŠ¤íŠ¸ëŠ” ê´€ë¦¬ì ê°€ë“œë¡œ í˜„ì¬ skip, ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš© í›„ ì‹œë‚˜ë¦¬ì˜¤ í™•ì¥ ì˜ˆì •

ë‹¤ìŒ ë‹¨ê³„
- ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ `alembic upgrade head` ì‹¤í–‰ í›„ `/docs` í™•ì¸ ë° OpenAPI ì¬ìˆ˜ì¶œ í•„ìš” ì‹œ `python -m app.export_openapi`
- í•œì • íŒ¨í‚¤ì§€/í”„ë¡œëª¨ ì½”ë“œ í…ŒìŠ¤íŠ¸ ë³´ê°•: ì¬ê³ /ì‚¬ìš©ìë³„ ì œí•œ/ê¸´ê¸‰ ë¹„í™œì„±í™”/í”„ë¡œëª¨ ìœ íš¨ê¸°ê°„ ë° ì‚¬ìš©ëŸ‰
- Pydantic v2 ë§ˆì´ê·¸ë ˆì´ì…˜: class-based Config â†’ ConfigDict ë‹¨ê³„ì  ì ìš©

ë³€ê²½ ìš”ì•½
- ê²½ì œ êµ¬ì¡° ë‹¨ì¼ í™”í(cyber_token_balance) ìœ ì§€ í™•ì •
- ìƒì  êµ¬ë§¤ API ì¶”ê°€: POST /api/shop/buy (kind=gems|item)
	- gems: ì½”ì¸ ì¶©ì „(PURCHASE_GEMS ë¡œê·¸)
	- item: ì½”ì¸ ì°¨ê° + êµ¬ë§¤ ê¸°ë¡(BUY_PACKAGE ë¡œê·¸)
- Alembic: user_actions(action_type, created_at) ì¸ë±ìŠ¤ ì¶”ê°€ ë¦¬ë¹„ì „ ì‘ì„±
- FE í—¬í¼ ì¶”ê°€: frontend/utils/actions.ts (postAction, postActionsBatch, buyProduct)

ê²€ì¦ ê²°ê³¼
- pytest: app/tests/test_shop_buy_api.py â†’ PASS (ì¶©ì „/ê³¼ê¸ˆ ì‹¤íŒ¨/ì •ìƒ êµ¬ë§¤ ì‹œë‚˜ë¦¬ì˜¤)
- ê¸°ì¡´ ì¸ì¦ ìŠ¤ëª¨í¬ í…ŒìŠ¤íŠ¸ â†’ PASS, heads ë‹¨ì¼ ì²´ì¸ ìœ ì§€ (ì‹ ê·œ ë¦¬ë¹„ì „: 20250813_user_actions_ix_type_created)

ë‹¤ìŒ ë‹¨ê³„
- ìƒí’ˆ ì¹´íƒˆë¡œê·¸/ê°€ê²©/í• ì¸ í…Œì´ë¸” ë„ì… ë° ê²€ì¦ ë¡œì§ ê°•í™”
- ì˜ìˆ˜ì¦(íŠ¸ëœì­ì…˜ ë¡œê·¸) ë°œí–‰/ì €ì¥ ë° ì¡°íšŒ API ì¶”ê°€
- ê²°ì œ ê²Œì´íŠ¸ì›¨ì´ ì—°ë™(ëª¨ì˜/ìƒŒë“œë°•ìŠ¤) ë° ì‹¤íŒ¨/í™˜ë¶ˆ í”Œë¡œìš° ì •ì˜

## 2025-08-13 ì—…ë°ì´íŠ¸

ë³€ê²½ ìš”ì•½
- ì‹¤ì‹œê°„ ì•Œë¦¼(WS/SSE) ê¸°ëŠ¥ ì™„ì„±: í† í”½ í•„í„°, ë‹¤ì¤‘ í´ë¼ì´ì–¸íŠ¸, ì¬ì—°ê²° ë°±í•„, ì •ìƒ í•´ì œ ì²˜ë¦¬ ë³´ê°•
- ì‚¬ìš©ì í–‰ë™ ë¡œê¹… API ì¶”ê°€: POST /api/actions, POST /api/actions/batch (PII ë§ˆìŠ¤í‚¹, DB ì €ì¥, ì„ íƒì  Kafka ë°œí–‰)
- ê´€ë ¨ í†µí•© í…ŒìŠ¤íŠ¸ ì¶”ê°€ ë° ì •ë¹„(ë¦¬ì–¼íƒ€ì„/ì•¡ì…˜)

ê²€ì¦ ê²°ê³¼
- pytest: app/tests/test_realtime_notifications.py, app/tests/test_actions_api.py â†’ PASS
- /docs ë…¸ì¶œ ì •ìƒ, WS/SSE ìŠ¤ëª¨í¬ OK, Last-Event-ID ì¬ê°œ ë™ì‘ í™•ì¸
- Alembic heads ë‹¨ì¼ ìœ ì§€(ì‹ ê·œ ë§ˆì´ê·¸ë ˆì´ì…˜ ë¶ˆí•„ìš”)

ë‹¤ìŒ ë‹¨ê³„
- user_actions ì¸ë±ìŠ¤: (user_id, created_at), (action_type, created_at) ì¶”ê°€ ê²€í†  ë° ì ìš©
- ë¡œê·¸ ë³´ê´€/ì••ì¶• ì •ì±… ìˆ˜ë¦½ê³¼ ì£¼ê¸° ì•„ì¹´ì´ë¹™ íŒŒì´í”„ë¼ì¸ ì„¤ê³„
- FE ì£¼ìš” í”Œë¡œìš°ì— /api/actions ì—°ë™ ë° ê³„ì¸¡ ëŒ€ì‹œë³´ë“œ í™•ì¥

### 2025-08-12 â€“ Post-merge validation (upstream-preferred)

- ë³€ê²½ ìš”ì•½: upstream/main ë³‘í•© ì´í›„ OpenAPI ì¬ìˆ˜ì¶œ ë° í•µì‹¬ ì¸ì¦ ìŠ¤ëª¨í¬ í…ŒìŠ¤íŠ¸ ì¬ê²€ì¦. ê²Œì„ ê°€ì±  ê²½ë¡œëŠ” í†µì¼ëœ `/api/games/gacha/pull`ë§Œ ìœ ì§€.
- ê²€ì¦: `python -m app.export_openapi` ì„±ê³µ, auth ìŠ¤ëª¨í¬ 12ê°œ PASS, Alembic head ê°€ë“œ PASS, `/health` OK.
- ë‹¤ìŒ ë‹¨ê³„: FE íƒ€ì… ì¬ìƒì„±(ì„ íƒ, openapi-typescript), ë ˆê±°ì‹œ `app/routers/gacha.py` ì™„ì „ ì œê±° ì—¬ë¶€ íŒ€ í•©ì˜ í›„ ì§„í–‰, ì „ì²´ í…ŒìŠ¤íŠ¸ ìŠ¤ìœ— ì£¼ê¸°ì  ì‹¤í–‰.

### 2025-08-12 â€“ Backend stability and Pydantic warning fix

- ë³€ê²½ ìš”ì•½:
	- chat_schemas.AIAssistantCreateì— Pydantic v2 `model_config = ConfigDict(protected_namespaces=())` ì ìš©í•˜ê³  ì¤‘ë³µ `class Config` ì œê±° â†’ `model_name/model_version` ê²½ê³  í•´ê²°.
	- app/database.py Postgres ì¬ì‹œë„ ì—°ê²° ë¡œì§ í™•ì¸(ì»¨í…Œì´ë„ˆ í™˜ê²½ì—ì„œ SQLite í´ë°± ë°©ì§€) ë° ë¡œê·¸ë¡œ ì„±ê³µ í™•ì¸.
	- ai_router: FastAPI Queryì˜ `regex=` ì‚¬ìš©ì„ `pattern=`ìœ¼ë¡œ êµì²´í•˜ì—¬ Pydantic v2 Deprecation ê²½ê³  ì œê±° (submit_ai_feedback).

- ê²€ì¦:
	- ì»¨í…Œì´ë„ˆ ë¡œê·¸ì—ì„œ Pydantic ë³´í˜¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê²½ê³  ì‚¬ë¼ì§ ë° ì•± ì¬ê¸°ë™ ì •ìƒ.
	- ì´ˆëŒ€ì½”ë“œ íšŒì›ê°€ì…/ë¡œê·¸ì¸ ë‹¨ì¼ í…ŒìŠ¤íŠ¸(app/tests/test_invite_signup_login_me.py) PASS, ê´€ë ¨ ê²½ê³  ìˆ˜ ê°ì†Œ í™•ì¸.
	- OpenAPI í™•ì¸: í”„ë¡œí•„ self ì—”ë“œí¬ì¸íŠ¸ëŠ” `/api/users/profile`(ë³„ì¹­ `/api/auth/me` í¬í•¨)ì´ë©° `/api/users/{id}/profile`ëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ. ê°€ì± ëŠ” `/api/games/gacha/pull` ë‹¨ì¼í™”.

- ì¶”ê°€: ë¡œê·¸ì¸/íšŒì›ê°€ì… ì‘ë‹µì— refresh_tokenì„ í¬í•¨í•˜ê³ , /api/auth/refreshì—ì„œ ê²€ì¦/íšŒì „í•˜ë„ë¡ DB ê¸°ë°˜ ë¦¬í”„ë ˆì‹œ í† í° ì €ì¥ì†Œ ì—°ë™. /api/auth/logout(-all)ë¡œ íê¸° ì§€ì›.

- ë‹¤ìŒ ë‹¨ê³„:
	- /api/auth/signup â†’ /api/auth/login â†’ /api/users/profile ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ë¡œì»¬ PowerShell 5.1 ìŠ¤í¬ë¦½íŠ¸ë¡œ ì¬í™•ì¸í•˜ê³  ê²°ê³¼ ìº¡ì²˜ë¥¼ ë³¸ ë¬¸ì„œì— ì¶”ê°€.
	- í•„ìš” ì‹œ OpenAPI ì¬ìˆ˜ì¶œ(`python -m app.export_openapi`) ë° í”„ë¡ íŠ¸ì—”ë“œ ìŠ¤í‚¤ë§ˆ ë™ê¸°í™”.
	- ì”ì—¬ Pydantic v2 class-based Config ê²½ê³ ëŠ” ë‹¨ê³„ì ìœ¼ë¡œ ConfigDictë¡œ ì´í–‰.

ì¶”ê°€ ë³€ê²½ (2025-08-12 ì €ë…)
- í”„ë¡œí•„ ë¬¸ì„œ ì •ì •: `GET /api/users/{id}/profile` â†’ `GET /api/users/profile`ë¡œ í‘œì¤€í™”, íƒ€ì¸ ì •ë³´ëŠ” `GET /api/users/{user_id}`ì—ì„œ ì œí•œ ì œê³µ.
- ë¬¸ì„œ(20250729-ê°€ì´ë“œ006.md) ì²´í¬ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ ë° ìƒíƒœ ë°˜ì˜.

ì¶”ê°€ ë³€ê²½ (2025-08-12 ë°¤)
- í…ŒìŠ¤íŠ¸ ë³´ê°•: ê°€ì±  ë¶„í¬ ê²€ì¦(pytest) 1000 pulls, ë¦¬í”„ë ˆì‹œ íšŒì „/íê¸° í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì¶”ê°€ ë° í†µê³¼.
- ê°€ì±  ë¶„í¬ í…ŒìŠ¤íŠ¸: RNG ì‹œë“œ ê³ ì •(random.seed(42)) ì ìš©ìœ¼ë¡œ ê²°ì •ë¡  ë³´ì¥ â†’ í—ˆìš©ì˜¤ì°¨ë¥¼ Â±5%ë¡œ ì¡°ì •.

- ê²€ì¦ ê²°ê³¼:
	- âœ… app/tests/test_gacha_distribution.py PASS (Common/Rare/Epic ë¶„í¬ í—ˆìš©ì˜¤ì°¨ ë‚´)
	- âœ… app/tests/test_auth_refresh_rotate_revoke.py PASS (ë¦¬í”„ë ˆì‹œâ†’íšŒì „, logout ì‹œ access ë¸”ë™ë¦¬ìŠ¤íŠ¸, revoke í™•ì¸)

- ë‹¤ìŒ ë‹¨ê³„:
	- ê°€ì±  pity(ì²œì¥) ì„¸ë¶€ ê·œì¹™ ë¬¸ì„œí™” ë° OpenAPI schema ì˜ˆì‹œ ì‘ë‹µì— animation_type/psychological_message ë°˜ì˜ ê²€í† 
	- CIì— ì‹ ê·œ í…ŒìŠ¤íŠ¸ í†µí•© ë° flake ëª¨ë‹ˆí„°ë§(ì‹œë“œ ê³ ì •ìœ¼ë¡œ ì•ˆì •í™”ë¨)

ê²€ì¦ ê²°ê³¼(2025-08-12 ë°¤ ì¶”ê°€)
- âœ… app/tests/test_gacha_distribution.py PASS (ì‹œë“œ ê³ ì •, Â±5% ê¸°ì¤€ ë§Œì¡±)
- âœ… app/tests/test_profile_privacy_and_games.py::test_gacha_bulk_pulls_and_costs_smoke PASS
- âœ… OpenAPI ì¬ìˆ˜ì¶œ ì™„ë£Œ (ì»¨í…Œì´ë„ˆ ë‚´ë¶€ python -m app.export_openapi)

# Casino-Club F2P í†µí•©/ì •ë¹„ ê°€ì´ë“œ (2025-08-08)

## 1. í˜„í™© ë° ë¬¸ì œ ìš”ì•½


ìµœì‹  ìƒíƒœ ìš”ì•½ (2025-08-08 ì €ë…)


ì¶”ê°€ ë©”ëª¨ (2025-08-09)
- Crash ë§ˆì´ê·¸ë ˆì´ì…˜(20250809_add_crash_tables_real.py): ê¸°ì¡´ í…Œì´ë¸”ê³¼ì˜ ì¶©ëŒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ idempotent SQL(IF NOT EXISTS, ì¡°ê±´ë¶€ UNIQUE/INDEX)ë¡œ ìˆ˜ì •. Alembic upgrade head ì„±ê³µ, í˜„ì¬ head: 20250809_add_crash_real
- ê²½ê³  ì •ë¦¬(ë¶€ë¶„): FastAPI Query regexâ†’pattern êµì²´, ì¼ë¶€ SQLAlchemy declarative_base importë¥¼ sqlalchemy.orm ê²½ë¡œë¡œ ë³€ê²½
- í”„ë¡ íŠ¸ íƒ€ì… ë³´ì™„: `frontend/types/api.ts`ì— Crash/Slot/RPS ì‘ë‹µ íƒ€ì… ìµœì†Œ ì •ì˜ ì¶”ê°€
- **ë‹¨ì¼ ì§„ì…ì /ë‹¨ì¼ ì†ŒìŠ¤ ìœ ì§€**: ë™ì¼ ëª©ì ì˜ íŒŒì¼ì€ í•˜ë‚˜ë§Œ ë‚¨ê¸°ê³ , ê°œì„ ì ì€ í†µí•©.
- **ëª¨ë“ˆë³„ ì±…ì„ ëª…í™•í™”**: ì¸ì¦, ê²Œì„, ìœ ì €, ê´€ë¦¬ ë“± ë„ë©”ì¸ë³„ë¡œ ë¼ìš°í„°/ì„œë¹„ìŠ¤/ìŠ¤í‚¤ë§ˆ ë¶„ë¦¬.
- **í™˜ê²½ì„¤ì • ì¼ì›í™”**: config.py í•˜ë‚˜ë¡œ í†µí•©, .env ì‚¬ìš© ê¶Œì¥.
- **API ìŠ¤í™/ë¬¸ì„œ ìë™í™”**: OpenAPI/Swagger ê¸°ë°˜ ë¬¸ì„œ ìë™ ìƒì„±.
- **í…ŒìŠ¤íŠ¸/ë°°í¬ ìë™í™”**: í†µí•© í…ŒìŠ¤íŠ¸, CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•.


## 3. ë‹¨ê³„ë³„ í†µí•©/ì •ë¹„ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 1) ì¤‘ë³µ íŒŒì¼ ì •ë¦¬
- [x] *_simple.py, *_fixed.py, *_temp.py, *_direct.py, *_v2.py ë“± ë¶ˆí•„ìš” íŒŒì¼ ì‚­ì œ
- [x] config.py, dependencies.py ë“± í™˜ê²½/ì˜ì¡´ì„± íŒŒì¼ ë‹¨ì¼í™”

- [x] games.pyì— game_api, game_api_v2 ê¸°ëŠ¥ ë³‘í•©
- [x] auth.pyì— simple/clean/temp ê¸°ëŠ¥ ë³‘í•©
- [x] OpenAPI ìŠ¤í™ ì¬ìƒì„± ë° ë¬¸ì„œí™” (íŒŒì¼: `cc-webapp/backend/current_openapi.json`)

### 3) í™˜ê²½ì„¤ì •/ë°°í¬ í†µí•©
- [x] CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶• (GitHub Actions)
	- ì›Œí¬í”Œë¡œìš°: `.github/workflows/ci.yml`
	- ì‘ì—…: frontend-tests(íƒ€ì…ì²´í¬+Jest), backend-tests(ì„œë¹„ìŠ¤ ê¸°ë™+ìŠ¤ëª¨í¬/pytest)
---

## 4. ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ & ì£¼ì˜ì‚¬í•­

- **ëª¨ë“  í†µí•©/ì‚­ì œ ì‘ì—… ì „ git backup ë¸Œëœì¹˜ ìƒì„±**
- **API ë³€ê²½ ì‹œ í”„ë¡ íŠ¸ì—”ë“œ/ë¬¸ì„œ/í…ŒìŠ¤íŠ¸ ì½”ë“œ ë™ì‹œ ìˆ˜ì •**
- **ë¶ˆí•„ìš”í•œ ì£¼ì„/ì½”ë“œ/íŒŒì¼ì€ ì¦‰ì‹œ ì œê±°**
- **ë¬¸ì„œ(README, API docs) ìµœì‹  ìƒíƒœ ìœ ì§€**
---

## 5. ì°¸ê³  ë¬¸ì„œ
- file-comparison-report.md
- README-SIMPLE.md


## 6. ë¹ ë¥¸ ì ê²€ìš© ì²´í¬ë¦¬ìŠ¤íŠ¸ (ë³µë¶™ìš©)

 - [x] í•µì‹¬ ë¼ìš°í„°/ì„œë¹„ìŠ¤/ìŠ¤í‚¤ë§ˆë§Œ ë‚¨ê²¼ëŠ”ì§€ í™•ì¸
- [ ] config.py/.envë§Œ ë‚¨ê¸°ê³  í™˜ê²½ì„¤ì • í†µì¼ (ì§„í–‰ ì¤‘: ìœ í‹¸ ìŠ¤í¬ë¦½íŠ¸ í™˜ê²½ë³€ìˆ˜í™”, ìµœì¢… í†µí•© ëŒ€ê¸°)
- [x] API ë¬¸ì„œ/ìŠ¤í™ ìµœì‹ í™” (OpenAPI ê°±ì‹  ë° ê²½ë¡œ í‘œì¤€í™”)
- [x] ì „ì²´ í…ŒìŠ¤íŠ¸ í†µê³¼ (í¬ë˜ì‹œ ë¼ì´í”„ì‚¬ì´í´ì€ í† í° ì œê³µ ì‹œ í†µê³¼)
- [ ] git commit/backup ì™„ë£Œ

---

 - ì¤‘ë³µ íŒŒì¼ ì •ë¦¬: ë£¨íŠ¸ `cc-webapp/current_openapi.json` ì œê±° ì™„ë£Œ
- ìƒì„± ë°©ì‹: ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ `python -m app.export_openapi` ì‹¤í–‰ ì‹œ ìë™ ê°±ì‹ 

## 8. Next Steps

 - Admin: Added bulk rewards grant endpoint
  - POST /api/admin/rewards/grant-bulk (per-user result with ok/error)

- Crash DB persistence strict mode: Set environment variable `CRASH_DB_STRICT=1` to fail-fast when DB insert/update fails during crash session `start_session` or `cashout`. Default remains best-effort (non-strict) for local dev. Location: `app/services/crash_session.py`.
- Admin audit endpoint: New `GET /api/admin/crash/sessions` to list recent crash sessions with optional filters `user_id`, `status`, and `limit` (default 50). Secured by admin auth. Useful for live ops verification and reconciliation.
- OpenAPI tag de-duplication: Normalized tags in `rewards` router and removed redundant tag overrides in `main.py` for `rewards` and `games` routers to avoid duplicate sections in `/docs`.
- CI gating switch: Backend crash tests can be made blocking by setting `CI_CRASH_BLOCKING=1` in the CI environment. Without it, the tests run in soft-fail mode to reduce friction during stabilization.

Verification
- Start a crash bet then call `GET /api/games/crash/debug/current` to verify session visibility; cash out and confirm row update in `crash_sessions` when strict mode is enabled.
- As an admin, call `GET /api/admin/crash/sessions?limit=10` and with filters (e.g., `&status=cashed`) to inspect latest sessions.
- Open `/docs` and confirm there is a single section for Rewards/Games.
 - OpenAPI: Exported latest schema (backend/current_openapi.json) reflecting new endpoints.

### 2025-08-13 â€“ API path/tag de-dup cleanup

- ë³€ê²½ ìš”ì•½:
	- Actions: ì¤‘ë³µ ê²½ë¡œ `/api/actions/actions` ì œê±° â†’ í‘œì¤€ `POST /api/actions`ë¡œ í†µì¼.
	- Rewards: íƒœê·¸ ëŒ€ì†Œë¬¸ì í˜¼ìš©(["Rewards"] vs ["rewards"]) ì •ë¦¬ â†’ ["Rewards"] ë‹¨ì¼í™”.
	- Games: `main.py`ì—ì„œ íƒœê·¸ ì˜¤ë²„ë¼ì´ë“œ ì œê±°ë¡œ "Games"/"Game Collection" ì¤‘ë³µ ì„¹ì…˜ í•´ì†Œ (ë¼ìš°í„° ë‚´ë¶€ íƒœê·¸ë§Œ ì‚¬ìš©).
- ê²€ì¦ ê²°ê³¼:
	- `pytest` ì¸ì¦ ìŠ¤ëª¨í¬ 12ê°œ PASS (ë³€ê²½ ì˜í–¥ ì—†ìŒ).
	- `python -m app.export_openapi` ì„±ê³µ, backend/current_openapi.json ê°±ì‹ .
	- Swagger `/docs`ì—ì„œ Rewards/Games ì„¹ì…˜ ì¤‘ë³µ ë¯¸ë°œìƒ í™•ì¸.
- ë‹¤ìŒ ë‹¨ê³„:
	- FEì—ì„œ ì‚¬ìš© ì¤‘ì¸ `/api/actions/actions` í˜¸ì¶œì´ ìˆë‹¤ë©´ `/api/actions`ë¡œ ê²½ë¡œ ê°±ì‹ .
	- í•„ìš” ì‹œ openapi-typescript ì¬ìƒì„± ë° íƒ€ì… ì—…ë°ì´íŠ¸.
	- ë¼ìš°í„° ì¶”ê°€ ì‹œ íƒœê·¸/í”„ë¦¬í”½ìŠ¤ ì¼ê´€ì„± ì ê²€ ì²´í¬ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€.

ì¶”ê°€ (2025-08-13)
- ì‹ ê·œ ìŠ¤í¬ë¦½íŠ¸: `scripts/test-ws.ps1` â€” WS ì—°ê²°/êµ¬ë…/í•´ì§€/LastEventId ë°±í•„ í…ŒìŠ¤íŠ¸ìš©.
- ë°±ì—”ë“œ READMEì— WS/SSE íŒŒì›Œì…¸ ì˜ˆì œ ì¶”ê°€.
- ë ˆê±°ì‹œ `app/websockets.py` ë° `app/websockets/__init__.py`ëŠ” `app.realtime.manager`ë¡œ ì…ˆë§í¬ ìˆ˜ì¤€ ë¦¬ìµìŠ¤í¬íŠ¸(Deprecated í‘œê¸°). ì‹ ê·œ ê¸°ëŠ¥ì€ `app/realtime.py`ë§Œ ì‚¬ìš©.

### 8.0 í…ŒìŠ¤íŠ¸/ì¸í”„ë¼ ìµœì‹  ìƒíƒœ (2025-08-08)


## ğŸ® ê²Œì„ API ì—°ë™ ë° í”„ë¡œí•„ í†µí•© ê°€ì´ë“œ (ìš°ì„ ìˆœìœ„ 5)

### ê°œìš”
í”„ë¡œí•„ í˜ì´ì§€ì—ì„œ ì‚¬ìš©ìì˜ ëª¨ë“  ê²Œì„ í™œë™, í†µê³„, ë³´ìƒ ë‚´ì—­ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” í†µí•© ì‹œìŠ¤í…œ êµ¬ì¶•

### 1. ê²Œì„ API ì—”ë“œí¬ì¸íŠ¸ ì„¤ê³„

#### 1.1 ê²Œì„ í†µê³„ ì¡°íšŒ API
```python
# /api/games/stats/{user_id}
@router.get("/games/stats/{user_id}")
async def get_game_stats(
    user_id: int,
    game_type: Optional[str] = None,  # 'slot', 'poker', 'blackjack', 'all'
    period: str = "week",  # 'day', 'week', 'month', 'all'
    db: Session = Depends(get_db)
) -> GameStatsResponse:
    """
    ì‚¬ìš©ì ê²Œì„ í†µê³„ ì¡°íšŒ
    - ì´ ê²Œì„ ìˆ˜, ìŠ¹ë¥ , ìˆ˜ìµë¥ 
    - ì„ í˜¸ ê²Œì„, í”Œë ˆì´ ì‹œê°„
    - ìµœê³  ê¸°ë¡, ì—°ìŠ¹ ê¸°ë¡
    """
```

#### 1.2 ì‹¤ì‹œê°„ ê²Œì„ ì„¸ì…˜ API
```python
# /api/games/session/{user_id}/current
@router.get("/games/session/{user_id}/current")
async def get_current_game_session(user_id: int):
    """í˜„ì¬ ì§„í–‰ì¤‘ì¸ ê²Œì„ ì„¸ì…˜ ì •ë³´"""

# /api/games/session/start
@router.post("/games/session/start")
async def start_game_session(game_data: GameSessionStart):
    """ê²Œì„ ì„¸ì…˜ ì‹œì‘"""

# /api/games/session/end
@router.post("/games/session/end")
async def end_game_session(session_data: GameSessionEnd):
    """ê²Œì„ ì„¸ì…˜ ì¢…ë£Œ ë° ê²°ê³¼ ì €ì¥"""
```

#### 1.3 ë³´ìƒ ë° ì—…ì  API
```python
# /api/games/achievements/{user_id}
@router.get("/games/achievements/{user_id}")
async def get_user_achievements(user_id: int):
    """ì‚¬ìš©ì ì—…ì  ë° ë³´ìƒ ë‚´ì—­"""

# /api/games/leaderboard
@router.get("/games/leaderboard")
async def get_leaderboard(
    game_type: str,
    period: str = "week",
    limit: int = 10
):
    """ê²Œì„ë³„ ë¦¬ë”ë³´ë“œ"""
```

### 2. í”„ë¡ íŠ¸ì—”ë“œ í†µí•© ì»´í¬ë„ŒíŠ¸

#### 2.1 GameStatsWidget ì»´í¬ë„ŒíŠ¸
```tsx
// components/profile/GameStatsWidget.tsx
interface GameStatsWidgetProps {
  userId: number;
  gameType?: string;
}

export function GameStatsWidget({ userId, gameType }: GameStatsWidgetProps) {
  const [stats, setStats] = useState<GameStats | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const fetchGameStats = async () => {
      try {
        const response = await fetch(`/api/games/stats/${userId}?game_type=${gameType}`);
        const data = await response.json();
        setStats(data);
      } catch (error) {
        console.error('ê²Œì„ í†µê³„ ë¡œë“œ ì‹¤íŒ¨:', error);
      } finally {
        setLoading(false);
      }
    };

    fetchGameStats();
    
    // ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•œ WebSocket ì—°ê²°
    const ws = new WebSocket(`ws://localhost:8000/ws/game-stats/${userId}`);
    ws.onmessage = (event) => {
      const updatedStats = JSON.parse(event.data);
      setStats(updatedStats);
    };

    return () => ws.close();
  }, [userId, gameType]);

  return (
    <div className="game-stats-widget">
      {/* ê²Œì„ í†µê³„ UI */}
    </div>
  );
}
```

#### 2.2 ì‹¤ì‹œê°„ ê²Œì„ í˜„í™© ì»´í¬ë„ŒíŠ¸
```tsx
// components/profile/LiveGameStatus.tsx
export function LiveGameStatus({ userId }: { userId: number }) {
  const [currentSession, setCurrentSession] = useState<GameSession | null>(null);

  return (
    <div className="live-game-status">
      {currentSession ? (
        <div className="bg-green-500/20 border border-green-500/30 rounded-xl p-4">
          <div className="flex items-center gap-2">
            <div className="w-3 h-3 bg-green-500 rounded-full animate-pulse" />
            <span className="text-green-400 font-semibold">ê²Œì„ ì§„í–‰ì¤‘</span>
          </div>
          <div className="mt-2 text-white">
            <div>ê²Œì„: {currentSession.gameType}</div>
            <div>ê²½ê³¼ ì‹œê°„: {formatDuration(currentSession.duration)}</div>
            <div>í˜„ì¬ ë² íŒ…: {currentSession.currentBet.toLocaleString()} í† í°</div>
          </div>
        </div>
      ) : (
        <div className="bg-gray-600/20 border border-gray-500/30 rounded-xl p-4">
          <span className="text-gray-400">í˜„ì¬ ê²Œì„ ì—†ìŒ</span>
        </div>
      )}
    </div>
  );
}
```

### 3. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ í™•ì¥

#### 3.1 ê²Œì„ ì„¸ì…˜ í…Œì´ë¸”
```sql
CREATE TABLE game_sessions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id INTEGER NOT NULL REFERENCES users(id),
    game_type VARCHAR(50) NOT NULL,
    game_variant VARCHAR(50), -- ê²Œì„ ë³€í˜• (ì˜ˆ: texas_holdem, european_roulette)
    start_time TIMESTAMP DEFAULT NOW(),
    end_time TIMESTAMP,
    initial_balance INTEGER NOT NULL,
    final_balance INTEGER,
    total_bet INTEGER DEFAULT 0,
    total_win INTEGER DEFAULT 0,
    net_result INTEGER DEFAULT 0,
    max_bet INTEGER DEFAULT 0,
    hand_count INTEGER DEFAULT 0, -- ì´ í•¸ë“œ/ìŠ¤í•€ ìˆ˜
    win_count INTEGER DEFAULT 0,
    session_data JSONB, -- ê²Œì„ë³„ ìƒì„¸ ë°ì´í„°
    status VARCHAR(20) DEFAULT 'active', -- active, completed, disconnected
    ip_address INET,
    user_agent TEXT
);

CREATE INDEX idx_game_sessions_user_time ON game_sessions(user_id, start_time);
CREATE INDEX idx_game_sessions_type ON game_sessions(game_type, start_time);
```

#### 3.2 ê²Œì„ í•¸ë“œ/ë¼ìš´ë“œ ìƒì„¸ í…Œì´ë¸”
```sql
CREATE TABLE game_hands (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    session_id UUID NOT NULL REFERENCES game_sessions(id),
    hand_number INTEGER NOT NULL,
    game_type VARCHAR(50) NOT NULL,
    bet_amount INTEGER NOT NULL,
    win_amount INTEGER DEFAULT 0,
    hand_data JSONB, -- ì¹´ë“œ, ì£¼ì‚¬ìœ„, ìŠ¬ë¡¯ ê²°ê³¼ ë“±
    hand_result VARCHAR(50), -- win, lose, push, bonus
    timestamp TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_game_hands_session ON game_hands(session_id, hand_number);
```

#### 3.3 ì—…ì  ë° ë°°ì§€ í…Œì´ë¸”
```sql
CREATE TABLE achievements (
    id SERIAL PRIMARY KEY,
    achievement_key VARCHAR(100) UNIQUE NOT NULL,
    name VARCHAR(200) NOT NULL,
    description TEXT,
    badge_icon VARCHAR(100),
    badge_color VARCHAR(50),
    requirements JSONB, -- ë‹¬ì„± ì¡°ê±´
    reward_tokens INTEGER DEFAULT 0,
    reward_items JSONB,
    is_active BOOLEAN DEFAULT true
);

CREATE TABLE user_achievements (
    id SERIAL PRIMARY KEY,
    user_id INTEGER NOT NULL REFERENCES users(id),
    achievement_id INTEGER NOT NULL REFERENCES achievements(id),
    achieved_at TIMESTAMP DEFAULT NOW(),
    progress_data JSONB, -- ë‹¬ì„± ê³¼ì • ë°ì´í„°
    
    UNIQUE(user_id, achievement_id)
);
```

### 4. ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ (WebSocket)

#### 4.1 WebSocket ì—°ê²° ê´€ë¦¬
```python
# websocket_manager.py
class GameStatsWebSocketManager:
    def __init__(self):
        self.active_connections: Dict[int, List[WebSocket]] = {}

    async def connect(self, websocket: WebSocket, user_id: int):
        await websocket.accept()
        if user_id not in self.active_connections:
            self.active_connections[user_id] = []
        self.active_connections[user_id].append(websocket)

    async def disconnect(self, websocket: WebSocket, user_id: int):
        if user_id in self.active_connections:
            self.active_connections[user_id].remove(websocket)

    async def send_stats_update(self, user_id: int, stats_data: dict):
        if user_id in self.active_connections:
            for connection in self.active_connections[user_id]:
                try:
                    await connection.send_json(stats_data)
                except ConnectionClosedOK:
                    await self.disconnect(connection, user_id)

# WebSocket ì—”ë“œí¬ì¸íŠ¸
@app.websocket("/ws/game-stats/{user_id}")
async def websocket_endpoint(websocket: WebSocket, user_id: int):
    await manager.connect(websocket, user_id)
    try:
        while True:
            await websocket.receive_text()
    except WebSocketDisconnect:
        await manager.disconnect(websocket, user_id)
```

### 5. í”„ë¡œí•„ í˜ì´ì§€ í†µí•©

#### 5.1 ProfileContainer í™•ì¥
```tsx
// ProfileContainer.tsx ìˆ˜ì •
export default function ProfileContainer() {
  const { user } = useUser();
  const [gameStats, setGameStats] = useState<GameStats | null>(null);
  const [achievements, setAchievements] = useState<Achievement[]>([]);

  return (
    <div className="profile-container">
      <ProfileHeader user={user} />
      <ProfileStats user={user} gameStats={gameStats} />
      
      {/* ìƒˆë¡œìš´ ê²Œì„ í†µê³„ ì„¹ì…˜ */}
      <GameStatsWidget userId={user.id} />
      <LiveGameStatus userId={user.id} />
      <AchievementsPanel achievements={achievements} />
      
      <MissionCards missions={missions} />
    </div>
  );
}




## [2025-08-11] ì•ˆì •í™” ì—…ë°ì´íŠ¸: Kafka ë¼ìš´ë“œíŠ¸ë¦½, CI ë§ˆì´ê·¸ë ˆì´ì…˜ ê²€ì¦, í…ŒìŠ¤íŠ¸ í•˜ì´ì§„

ë³€ê²½ ìš”ì•½
- Kafka ë¼ìš´ë“œíŠ¸ë¦½ í…ŒìŠ¤íŠ¸ë¥¼ debug/peek ì—”ë“œí¬ì¸íŠ¸ ê¸°ë°˜ìœ¼ë¡œ ì „í™˜í•´ ë¹„ê²°ì •ì„± ì œê±°. in-process ë²„í¼ ì˜ì¡´ ì—†ì´ ë¸Œë¡œì»¤ì—ì„œ ì§ì ‘ ì½ì–´ ë‹¨ì •. ëŒ€ìƒ íŒŒì¼: `app/tests/test_kafka_roundtrip.py`.
- CI ì›Œí¬í”Œë¡œìš°ì— Alembic history ì¶œë ¥ê³¼ ëª…ì‹œì  downgrade(-1 í—ˆìš©)/upgrade head ë‹¨ê³„ë¥¼ ì¶”ê°€í•´ ë§ˆì´ê·¸ë ˆì´ì…˜ ì•ˆì „ì„± í™•ë³´. ëŒ€ìƒ íŒŒì¼: `.github/workflows/ci.yml`.
- CI í•„ìˆ˜ ê²Œì´íŠ¸ë¥¼ ìµœì†Œ ê·¸ë¦° ê²½ë¡œ í…ŒìŠ¤íŠ¸ë¡œ í•œì •: `app/tests/test_user_journey.py`, `app/tests/test_kafka_roundtrip.py`.
- í…ŒìŠ¤íŠ¸ í•˜ì´ì§„: pytest.iniì—ì„œ `--ignore=tests` ìœ ì§€ë¡œ ì¤‘ë³µ ê²½ë¡œ ìˆ˜ì§‘ ì°¨ë‹¨. ë ˆê±°ì‹œ `tests/`ëŠ” ì ì§„ ë³´ìˆ˜ í›„ ì¬í™œì„±í™” ì˜ˆì •.

ê²€ì¦ ê²°ê³¼
- ì»¨í…Œì´ë„ˆ ë‚´ë¶€:
  - `alembic heads` â†’ [í˜„ì¬ ë¦¬í¬ ìƒíƒœ ê¸°ì¤€] ë¦¬ë¹„ì „ ë©”íƒ€ ëˆ„ë½ìœ¼ë¡œ ì‹¤íŒ¨. ë‹¨ì¼ head ë³µêµ¬ í•„ìš”.
  - `pytest -q app/tests/test_user_journey.py` â†’ PASS
  - `pytest -q app/tests/test_kafka_roundtrip.py` â†’ debug/peek ê¸°ë°˜ ë¼ìš´ë“œíŠ¸ë¦½ PASS (ë¸Œë¡œì»¤ í™œì„± ì‹œ)
- OpenAPI ì¬ìˆ˜ì¶œ ì™„ë£Œ (`cc-webapp/backend/current_openapi.json`).

ë‹¤ìŒ ë‹¨ê³„
- Kafka ì „ìš© ê²©ë¦¬ í† í”½(KAFKA_TEST_TOPIC=cc_test_ci)ë¡œ CI ê°„ ê°„ì„­ ë°©ì§€ ê°•í™” ë° í† í”½ ìë™ìƒì„± ìƒíƒœ í™•ì¸.
- ë ˆê±°ì‹œ `tests/` ê²½ë¡œì˜ import/ìŠ¤í‚¤ë§ˆ ë¶ˆì¼ì¹˜ ìˆ˜ì • í›„ ë§ˆì´ê·¸ë ˆì´ì…˜, games, auth í…ŒìŠ¤íŠ¸ ì ì§„ì  ì¬í™œì„±í™”.
- Alembic explicit downgrade ëŒ€ìƒ ë¦¬ë¹„ì „ì„ ê³ ì •(merge í† í´ë¡œì§€ ê³ ë ¤)í•˜ê³  ì´ë ¥ ê·¸ë˜í”„ ìë™ ì ê²€ ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€.

---

## [2025-08-11] ëŸ°ë¶ ì¬ê²€ì¦ ë° Alembic ìŠ¤í‚¤ë§ˆ ì¸ì‹ ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš©

ë³€ê²½ ìš”ì•½
- CI í…ŒìŠ¤íŠ¸ ìŠ¤íƒ ê¸°ë™ ì‹œ ZooKeeper/Kafka ì„œë¹„ìŠ¤ë¥¼ í•¨ê»˜ ì‹œì‘í•˜ë„ë¡ ì—…ë°ì´íŠ¸(.github/workflows/ci.yml)í•´ ì¹´í”„ì¹´ ê¸°ë°˜ í…ŒìŠ¤íŠ¸ ì•ˆì •í™”.
- Alembic ë¦¬ë¹„ì „ 20250811_core_ixë¥¼ ìŠ¤í‚¤ë§ˆ ì¸ì‹(schema-aware) ë°©ì‹ìœ¼ë¡œ ìˆ˜ì •. ì¡´ì¬í•˜ëŠ” í…Œì´ë¸”/ì»¬ëŸ¼ë§Œ ì¸ë±ìŠ¤Â·ì œì•½ì„ ìƒì„±í•˜ê³ , user_actions.created_at/timestamp ë“± í™˜ê²½ì°¨ë¥¼ ì•ˆì „ ì²˜ë¦¬. user_game_stats/game_stats ì–‘ì í˜¸í™˜ ìœ ë‹ˆí¬ ì œì•½ ìƒì„±.
- ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ê¸°ì¤€ ëŸ°ë¶ ìˆ˜í–‰: ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš©, OpenAPI ì¬ìˆ˜ì¶œ, ìŠ¤ëª¨í¬/ì €ë‹ˆ í…ŒìŠ¤íŠ¸ ì‹¤í–‰.

ê²€ì¦ ê²°ê³¼
- ì»¨í…Œì´ë„ˆ ìƒíƒœ: postgres/redis/zookeeper/kafka/backend ëª¨ë‘ Up(healthy). í…ŒìŠ¤íŠ¸ìš© zookeeper_test/kafka_testë„ ê¸°ë™ í™•ì¸.
- Alembic: [í˜„ì¬ ë¦¬í¬ ìƒíƒœ ê¸°ì¤€] heads ì‹¤í–‰ ì‹¤íŒ¨(ë¦¬ë¹„ì „ ë©”íƒ€ ëˆ„ë½). ë³´ì • í›„ ë‹¨ì¼ head ë³µêµ¬ ì˜ˆì •.
- OpenAPI: current_openapi.json ì¬ìƒì„± ì„±ê³µ.
- í…ŒìŠ¤íŠ¸: app/tests/test_smoke_health.py, app/tests/test_user_journey.py í†µê³¼.

ë‹¤ìŒ ë‹¨ê³„
- CIì—ì„œ Kafka ë¼ìš´ë“œíŠ¸ë¦½ í…ŒìŠ¤íŠ¸ë¥¼ í”Œë˜ê·¸(KAFKA_ENABLED)ë¡œ ì˜µì…˜í™”í•˜ì—¬ í™˜ê²½ ì˜ì¡´ì„± ì™„í™”, ê²©ë¦¬ í† í”½(KAFKA_TEST_TOPIC) ê³ ì • ìœ ì§€.
- Pydantic v2 ê²½ê³  ì œê±°(ConfigDict ì „í™˜, protected_namespaces ì¶©ëŒ í•´ì†Œ).
- íŠ¸ëœì­ì…˜/ACID ë²”ìœ„ í…ŒìŠ¤íŠ¸ í™•ì¥ ë° ë°±ì—…/ë³µêµ¬ ìë™ ê²€ì¦ ì¶”ê°€.

---

## [2025-08-11] ìš´ì˜ ê°€ì´ë“œ ë™ê¸°í™” (override, ìŠ¤í¬ë¦½íŠ¸, Alembic ì ê²€ í˜„í™©)

ë³€ê²½ ìš”ì•½
- docker-compose.override.local.yml ë„ì…ìœ¼ë¡œ í¬íŠ¸(3001/8001/5433) ì¬ë§¤í•‘ ë° ë¡œì»¬ ì¶©ëŒ í•´ì†Œ.
- cc-manage.ps1ì— override/.env.local ìë™ í¬í•¨ ë° pg_isready ë˜í•‘ìœ¼ë¡œ DB ì²´í¬ ë…¸ì´ì¦ˆ ì œê±°.
- Kafka ë¹„í™œì„± ê²½ë¡œì˜ /api/kafka/produce ìƒíƒœì½”ë“œë¥¼ 502ë¡œ í‘œì¤€í™”(í…ŒìŠ¤íŠ¸ ê¸°ëŒ€ì™€ ì¼ì¹˜).
- Alembic ë¦¬ë¹„ì „ ì¼ë¶€ì— revision/down_revision ë©”íƒ€ ëˆ„ë½ ë°œê²¬ â†’ heads ì‹¤íŒ¨, ë‹¨ì¼ head ë³µêµ¬ ì‘ì—… ì˜ˆì •.

ê²€ì¦ ê²°ê³¼
- ì»¨í…Œì´ë„ˆ/í—¬ìŠ¤: PASS (frontend 3001, backend 8001, postgres 5433).
- DB ì²´í¬: PASS (pg_isready accepting connections, SELECT 1 OK).
- í…ŒìŠ¤íŠ¸: Kafka disabled ê²½ë¡œ PASS(502 í—ˆìš©). ë¼ìš´ë“œíŠ¸ë¦½ì€ ì„ íƒ ê²€ì¦.
- Alembic heads: FAIL(ë©”íƒ€ ëˆ„ë½) â†’ ìˆ˜ì • í›„ ì¬ê²€ì¦ í•„ìš”.

ë‹¤ìŒ ë‹¨ê³„
- Alembic ë³´ì •: ëˆ„ë½ ë¦¬ë¹„ì „ì— revision/down_revision ì¶”ê°€, í•„ìš” ì‹œ merge ìƒì„±ìœ¼ë¡œ ë‹¨ì¼ head ìœ ì§€(f79d04ea1016 ê¸°ì¤€).
- ë¬¸ì„œ/ìŠ¤í‚¤ë§ˆ: OpenAPI ì¬ìˆ˜ì¶œ(cc-webapp/backend/current_openapi.json) ë° ë³¸ ë¬¸ì„œ/20250808.mdì— ë³€ê²½ ë°˜ì˜.
- ì„ íƒ ê°œì„ : Kafka consumer ë¼ìš´ë“œíŠ¸ë¦½ ì•ˆì •í™”, CI ì˜µì…˜ í”Œë˜ê·¸ ì¬í™•ì¸, í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ì ê²€.

---

## [2025-08-11] í…ŒìŠ¤íŠ¸ ì‹¤í–‰/í™˜ê²½ ë©”ëª¨ (pytest PATH, ê²½ê³  ì²˜ë¦¬)

ìš”ì•½
- VS Code Taskì—ì„œ bare `pytest`ëŠ” PATH ë¯¸ì„¤ì •ìœ¼ë¡œ ì‹¤íŒ¨í•  ìˆ˜ ìˆìŒ. `python -m pytest`ë¡œ ì‹¤í–‰í•˜ë©´ ì •ìƒ ë™ì‘.
- ë°±ì—”ë“œ ë£¨íŠ¸(`cc-webapp/backend`)ì—ì„œ ì‹¤í–‰í•´ì•¼ `app` ëª¨ë“ˆì´ PYTHONPATHì— ë…¸ì¶œë˜ì–´ import ì—ëŸ¬ë¥¼ íšŒí”¼í•¨.

ê¶Œì¥ ì‹¤í–‰ ì˜ˆì‹œ (Windows PowerShell)
```powershell
cd c:/Users/bdbd/0001/0801/cc-webapp/backend
C:/Users/bdbd/AppData/Local/Programs/Python/Python311/python.exe -m pytest -q app/tests/test_auth_refresh_flow.py app/tests/test_invite_signup_login_me.py app/tests/test_auth_lockout_me_alias.py
```

í˜„ì¬ ìƒíƒœ
- í…ŒìŠ¤íŠ¸ ê²°ê³¼: 7 passed, 28 warnings (ì•½ 3.6s)
- ê²½ê³  ìœ í˜•:
  - Pydantic v2: class-based `config` ì‚¬ìš© Deprecated â†’ ConfigDictë¡œ ì „í™˜ í•„ìš”
  - FastAPI Query `regex` íŒŒë¼ë¯¸í„° Deprecated â†’ `pattern`ìœ¼ë¡œ êµì²´ í•„ìš” (ì˜ˆ: `app/routers/ai_router.py`)

í›„ì† ì¡°ì¹˜(ê¶Œì¥)
- Pydantic v2 ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œì— ë”°ë¼ ëª¨ë¸ ì„¤ì •ì„ `ConfigDict`ë¡œ ì „í™˜ (ì ì§„ ì ìš©)
- FastAPI íŒŒë¼ë¯¸í„° ìœ íš¨ì„±ì˜ `regex` â†’ `pattern` êµì²´ ë° í…ŒìŠ¤íŠ¸ ë³´ê°•
- VS Code Task ì—…ë°ì´íŠ¸: `python -m pytest` í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•˜ê±°ë‚˜, ê°€ìƒí™˜ê²½/PATHë¥¼ ëª…í™•íˆ ì„¤ì •

ê²€ì¦ ìŠ¤ëƒ…ìƒ·
- OpenAPI ì¬ìˆ˜ì¶œ ì„±ê³µ: `python -m app.export_openapi` â†’ `current_openapi.json` ê°±ì‹ 
- Auth í”Œë¡œìš° í…ŒìŠ¤íŠ¸ í†µê³¼: refresh, signup/login/me, lockout, `/api/auth/me` alias ë™ì‘ í™•ì¸

## Kafka ìµœì¢… í†µí•© ë° ê²€ì¦ ê²°ê³¼ (2025-07-29)

- Kafka Producer/Consumerê°€ ì •ìƒì ìœ¼ë¡œ ì—°ê²° ë° ë©”ì‹œì§€ ì†¡ìˆ˜ì‹ ì„ ìˆ˜í–‰í•¨ì„ í™•ì¸
- ë¡œê·¸ì—ì„œ IPv6 í™˜ê²½ì—ì„œë„ ë¬¸ì œì—†ì´ ì—°ê²°ë¨ì„ ê²€ì¦
- ì‹¤ì œ ë©”ì‹œì§€ ì „ì†¡ ë° ì¢…ë£Œê¹Œì§€ ëª¨ë“  ë‹¨ê³„ì—ì„œ ì„±ê³µ ë¡œê·¸ í™•ì¸
- Casino-Club F2P ë°±ì—”ë“œì˜ ì‹¤ì‹œê°„ ì´ë²¤íŠ¸/ì•¡ì…˜ íŒŒì´í”„ë¼ì¸ì´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•¨ì„ ìµœì¢… ê²€ì¦
- ë‹¤ìŒ ë‹¨ê³„: ì‹¤ì‹œê°„ í”¼ë“œë°±, ì•Œë¦¼, ë¶„ì„ ì´ë²¤íŠ¸ ë“± ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ì˜ í†µí•© ë° ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ ì—°ë™

```
INFO:kafka.conn:<BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9093 <connecting> [IPv6 ('::1', 9093, 0, 0)]>: connecting to localhost:9093 [('::1', 9093, 0, 0) IPv6]
INFO:kafka.conn:<BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9093 <checking_api_versions_recv> [IPv6 ('::1', 9093, 0, 0)]>: Broker version identified as 2.6
INFO:kafka.conn:<BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9093 <connected> [IPv6 ('::1', 9093, 0, 0)]>: Connection complete.
INFO:backend.app.core.kafka_client:âœ… Kafka Producer ì—°ê²° ì„±ê³µ
INFO:kafka.conn:<BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9093 <connecting> [IPv6 ('::1', 9093, 0, 0)]>: connecting to localhost:9093 [('::1', 9093, 0, 0) IPv6]
INFO:kafka.conn:<BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9093 <connected> [IPv6 ('::1', 9093, 0, 0)]>: Connection complete.
INFO:kafka.conn:<BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9093 <connected> [IPv6 ('::1', 9093, 0, 0)]>: Closing connection.
INFO:backend.app.core.kafka_client:âœ… ì‚¬ìš©ì ì•¡ì…˜ ì „ì†¡ ì„±ê³µ: FINAL_VALIDATION for test_user_final
 Kafka ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ!
INFO:kafka.producer.kafka:<KafkaProducer client_id=kafka-python-producer-1 transactional_id=None>: Closing the Kafka producer with 4294967.0 secs timeout.
INFO:kafka.conn:<BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9093 <connected> [IPv6 ('::1', 9093, 0, 0)]>: Closing connection.
INFO:backend.app.core.kafka_client:âœ… Kafka Producer ì—°ê²° ì¢…ë£Œ
```

---
**ê²°ë¡ :**
- Casino-Club F2P ë°±ì—”ë“œì˜ Kafka ì‹¤ì‹œê°„ ë©”ì‹œì§• ì¸í”„ë¼ê°€ ì™„ì „íˆ ê²€ì¦ë¨
- ì‹¤ì„œë¹„ìŠ¤ ì—°ë™ ë° í™•ì¥ì— ì í•©í•œ êµ¬ì¡°ë¡œ ì•ˆì •í™” ì™„ë£Œ


ë¬¸ì œì™€ í•´ê²°
- ì¦ìƒ: pytest ìˆ˜ì§‘ ì¤‘ ì˜¤ë¥˜ â€œClient.__init__() got an unexpected keyword argument 'app'â€
- ì›ì¸: ì»¨í…Œì´ë„ˆ ë‚´ë¶€ httpx ë²„ì „ 0.28.1ë¡œ Starlette/FastAPI TestClientì™€ í˜¸í™˜ ì´ìŠˆ
- ì¡°ì¹˜: httpx 0.27.0ìœ¼ë¡œ ë‹¤ìš´ê·¸ë ˆì´ë“œ(ìš”êµ¬ì‚¬í•­ê³¼ ì¼ì¹˜) í›„ í…ŒìŠ¤íŠ¸ ì¬ì‹¤í–‰

ì‹¤í–‰ ê²°ê³¼
- ì—£ì§€ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸: PASS (ê²½ê³  ì¡´ì¬í•˜ë‚˜ ê¸°ëŠ¥ ì˜í–¥ ì—†ìŒ)
- í¬ë˜ì‹œ ë¼ì´í”„ì‚¬ì´í´ í…ŒìŠ¤íŠ¸: TEST_USER_TOKEN ì—†ìœ¼ë©´ skip, í† í° ì œê³µ ì‹œ í†µê³¼
- OpenAPI: /api/admin/rewards/grant-bulk, /api/admin/crash/sessions ë…¸ì¶œ í™•ì¸
- DB: crash_sessions, crash_bets í…Œì´ë¸” ì¡´ì¬ í™•ì¸

ë‚¨ì€ ê²½ê³ /ì£¼ì˜
- pytest mark ê²½ê³ (order, integration): order ë§ˆì»¤ ë“±ë¡ ì™„ë£Œ, í•„ìš” ì‹œ í”ŒëŸ¬ê·¸ì¸ ë„ì… ê³ ë ¤
- FastAPI on_event, pydantic/SQLAlchemy deprecation: ì°¨ê¸° ë¦¬íŒ©í† ë§ì—ì„œ lifespan ì „í™˜ ë° ë§ˆì´ê·¸ë ˆì´ì…˜ ëŒ€ì‘ í•„ìš”
- Alembic: ë‹¤ì¤‘ head ì¡´ì¬ë¡œ head ì—…ê·¸ë ˆì´ë“œëŠ” ë¶ˆê°€, íŠ¹ì • ë¦¬ë¹„ì „ ëŒ€ìƒ ì—…ê·¸ë ˆì´ë“œ ìš´ìš© ì¤‘(í–¥í›„ ë³‘í•© í•„ìš”)

### 8.1 ê²€ì¦ ê°€ì´ë“œ (Admin ì‹ ê·œ ì—”ë“œí¬ì¸íŠ¸/WS)

ì‚¬ì „ ì¤€ë¹„
- ë°±ì—”ë“œÂ·DB ì»¨í…Œì´ë„ˆ ê¸°ë™ ìƒíƒœ í™•ì¸ (http://localhost:8000/health = 200)
- í…ŒìŠ¤íŠ¸ìš© ê´€ë¦¬ì ê³„ì • ì¤€ë¹„(ê¶Œì¥): ê¸°ì¡´ ê³„ì •ì„ ê´€ë¦¬ì ìŠ¹ê²©í•˜ê±°ë‚˜ ê´€ë¦¬ì í† í° ì‚¬ìš©
	- (ì„ íƒ) ê´€ë¦¬ì ìŠ¹ê²© ì˜ˆì‹œ: ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ìŠ¤í¬ë¦½íŠ¸ í™œìš©
		- PowerShell
			```powershell
			docker exec cc_backend python /app/promote_admin.py --site-id <YOUR_SITE_ID>
			```

1) OpenAPI ìµœì‹  ë°˜ì˜ í™•ì¸
- ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ OpenAPI ì¬ìˆ˜ì¶œ í›„ íŒŒì¼ í™•ì¸
	- PowerShell
		```powershell
		docker exec cc_backend python -m app.export_openapi
		docker exec cc_backend cmd /c type current_openapi.json | powershell -Command "$input | Select-String 'admin/notifications' -SimpleMatch"
		docker exec cc_backend cmd /c type current_openapi.json | powershell -Command "$input | Select-String 'rewards/grant-bulk' -SimpleMatch"
		```

2) WebSocket ì—°ê²° í™•ì¸ (/ws/notifications/{user_id})
- ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ê°„ë‹¨ í…ŒìŠ¤íŠ¸ (F12 â†’ Console)
	```javascript
	const uid = 1; // ì—°ê²°í•˜ë ¤ëŠ” ì‚¬ìš©ì ID
	const ws = new WebSocket(`ws://localhost:8000/ws/notifications/${uid}`);
	ws.onmessage = (e) => console.log('WS message:', e.data);
	ws.onopen = () => console.log('WS connected');
	ws.onclose = () => console.log('WS closed');
	```

3) Broadcast ì•Œë¦¼ í…ŒìŠ¤íŠ¸
- ëª¨ë“  ì—°ê²° ì‚¬ìš©ìì—ê²Œ ë¸Œë¡œë“œìºìŠ¤íŠ¸
	- PowerShell (ê´€ë¦¬ì í† í° í•„ìš” ì‹œ í—¤ë” ì¶”ê°€)
		```powershell
		$body = @{ title = 'Maintenance'; body = 'Starts 2am'; data = @{ reason = 'routine' } } | ConvertTo-Json
		Invoke-RestMethod -Method Post -Uri "http://localhost:8000/api/admin/notifications/broadcast" -ContentType 'application/json' -Body $body # -Headers @{ Authorization = 'Bearer <ADMIN_JWT>' }
		```
- ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ WS ìˆ˜ì‹  ë¡œê·¸ í™•ì¸: type=ADMIN_BROADCAST í˜ì´ë¡œë“œê°€ ì¶œë ¥ë˜ì–´ì•¼ í•¨

4) Targeted ì•Œë¦¼ í…ŒìŠ¤íŠ¸
- íŠ¹ì • ì‚¬ìš©ìì—ê²Œë§Œ ë°œì†¡
	- PowerShell
		```powershell
		$body = @{ title = 'Hi'; body = 'Personal message'; user_id = 1; data = @{ note = 'vip' } } | ConvertTo-Json
		Invoke-RestMethod -Method Post -Uri "http://localhost:8000/api/admin/notifications/send" -ContentType 'application/json' -Body $body # -Headers @{ Authorization = 'Bearer <ADMIN_JWT>' }
		```
- í•´ë‹¹ ì‚¬ìš©ìë¡œ ì—°ê²°ëœ WS ì½˜ì†”ì—ì„œ type=ADMIN_NOTIFICATION ë©”ì‹œì§€ê°€ ë„ì°©í•´ì•¼ í•¨

5) ë³´ìƒ ëŒ€ëŸ‰ì§€ê¸‰ í…ŒìŠ¤íŠ¸ (grant-bulk)
- ì—¬ëŸ¬ ì‚¬ìš©ìì—ê²Œ ë³´ìƒ ì§€ê¸‰ ê²°ê³¼ í™•ì¸
	- PowerShell
		```powershell
		$items = @(
			@{ user_id = 1; reward_type = 'TOKEN'; amount = 100; source_description = 'promo:aug' },
			@{ user_id = 99999; reward_type = 'TOKEN'; amount = 50; source_description = 'promo:aug' }
		)
		$body = @{ items = $items } | ConvertTo-Json -Depth 4
		Invoke-RestMethod -Method Post -Uri "http://localhost:8000/api/admin/rewards/grant-bulk" -ContentType 'application/json' -Body $body # -Headers @{ Authorization = 'Bearer <ADMIN_JWT>' }
		```
- ê¸°ëŒ€ ê²°ê³¼: `results` ë°°ì—´ì— ì‚¬ìš©ìë³„ {status: "ok"|"error"}ê°€ í¬í•¨. ì „ì²´ ì„±ê³µ ì‹œ success=true

6) ìµœì†Œ Pytest ìŠ¤ëª¨í¬ (ì„ íƒ)
- ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ë¹ ë¥¸ ê²€ì¦: ì‹ ê·œ ì—”ë“œí¬ì¸íŠ¸ê°€ 2xx/4xxë¡œ ì•ˆì •ì ìœ¼ë¡œ ì‘ë‹µí•˜ëŠ”ì§€ í™•ì¸
	- PowerShell
		```powershell
		docker exec cc_backend pytest -q tests/test_admin_endpoints.py -q
		```

ë¬¸ì œ ë°œìƒ ì‹œ ì²´í¬
- 401/403: ê´€ë¦¬ì ê¶Œí•œ/í† í° ëˆ„ë½ ì—¬ë¶€ í™•ì¸, require_admin_access ì˜ì¡´ì„± í™•ì¸
- 404: ë¼ìš°í„° ë¯¸í¬í•¨ ì—¬ë¶€(app.main ë¼ìš°í„° ë“±ë¡) ë˜ëŠ” ê²½ë¡œ ì˜¤íƒ€ í™•ì¸
- WS ë¯¸ìˆ˜ì‹ : ë¸Œë¼ìš°ì € ì½˜ì†” ì—ëŸ¬/ë„¤íŠ¸ì›Œí¬ íƒ­ í™•ì¸, ë°©í™”ë²½/í”„ë¡ì‹œ ì˜í–¥ ì ê²€

---

### 8.2 ë¼ìš°í„°/ì˜¤í”ˆAPI ë™ê¸°í™” íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

ì¦ìƒ: ì‹ ê·œ Admin ì—”ë“œí¬ì¸íŠ¸ê°€ OpenAPI(`current_openapi.json`)ì— ë‚˜íƒ€ë‚˜ì§€ ì•Šê±°ë‚˜ 404 ë°œìƒ.

ì›ì¸ í›„ë³´
- OpenAPI ìŠ¤í‚¤ë§ˆ ìºì‹œ(app.openapi_schema) ë¯¸ë¬´íš¨í™”
- ë°±ì—”ë“œ í”„ë¡œì„¸ìŠ¤ ë¯¸ì¬ê¸°ë™(ì½”ë“œ ë¡œë“œ íƒ€ì´ë° ë¬¸ì œ)
- ë¼ìš°í„° ë¯¸ë“±ë¡(app.mainì—ì„œ include_router ëˆ„ë½) ë˜ëŠ” ê²½ë¡œ í”„ë¦¬í”½ìŠ¤ ìƒì´
- ì¤‘ë³µ íŒŒì¼/ê²½ë¡œë¡œ ì˜ëª»ëœ ëª¨ë“ˆì´ importë¨(ì˜ˆ: admin.pyê°€ 2ê°œ ì´ìƒ ì¡´ì¬)

ê¶Œì¥ ì ê²€ ìˆœì„œ (PowerShell)
1) ìŠ¤í‚¤ë§ˆ ìºì‹œ ë¬´íš¨í™” í›„ ì¬ìˆ˜ì¶œ
	```powershell
	docker exec cc_backend python -m app.export_openapi
	docker exec cc_backend cmd /c type current_openapi.json | powershell -Command "$input | Select-String 'admin/notifications' -SimpleMatch"
	docker exec cc_backend cmd /c type current_openapi.json | powershell -Command "$input | Select-String 'rewards/grant-bulk' -SimpleMatch"
	```
2) ë°±ì—”ë“œ ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘(í”„ë¡œì„¸ìŠ¤/ëª¨ë“ˆ ë¦¬ë¡œë“œ ê°•ì œ)
	```powershell
	docker restart cc_backend
	docker exec cc_backend python -m app.export_openapi
	docker exec cc_backend python -c "from app.main import app; app.openapi_schema=None; s=app.openapi(); import json; print(json.dumps([p for p in s['paths'].keys() if p.startswith('/api/admin/')]))"
	```
3) ë¼ìš°í„° ë“±ë¡/ëª¨ë“ˆ ê²½ë¡œ í™•ì¸
	```powershell
	# app.mainì— admin ë¼ìš°í„°ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ ì‹¤í–‰ ì‹œì  ìŠ¤ëƒ…ìƒ·
	docker exec cc_backend python - << 'PY'
from app.main import app
from importlib import import_module
import json

app.openapi_schema=None
s = app.openapi()
admin_paths = sorted([p for p in s['paths'].keys() if p.startswith('/api/admin/')])
print('ADMIN_PATHS=', json.dumps(admin_paths))

# admin ë¼ìš°í„° ì‹¤ì œ íŒŒì¼ ê²½ë¡œ ì¶”ì 
admin_mod = import_module('app.routers.admin')
print('ADMIN_MODULE_FILE=', getattr(admin_mod, '__file__', 'n/a'))
PY
	```
	- ADMIN_MODULE_FILEê°€ ê¸°ëŒ€ ê²½ë¡œ(`/app/app/routers/admin.py`)ê°€ ì•„ë‹ˆë©´ ì˜ëª»ëœ ëª¨ë“ˆì´ ë¡œë“œë˜ê³  ìˆëŠ” ê²ƒ.

4) í”í•œ ì‹¤ìˆ˜/í•´ê²°
	- export_openapiì— `app.openapi_schema = None` ëˆ„ë½ â†’ ìŠ¤í‚¤ë§ˆì— ì‹ ê·œ ê²½ë¡œ ë¯¸ë°˜ì˜
	- uvicorn --reload ë¯¸ì‚¬ìš© í™˜ê²½ì—ì„œ ì½”ë“œë§Œ ë°”ë€Œê³  í”„ë¡œì„¸ìŠ¤ëŠ” ìœ ì§€ â†’ ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘ í•„ìš”
	- ë™ì¼ ì´ë¦„ íŒŒì¼ì´ ë‹¤ë¥¸ í´ë”ì— ì¡´ì¬ â†’ import ìš°ì„ ìˆœìœ„ì— ì˜í•´ ê³¼ê±° íŒŒì¼ ë¡œë“œë¨ â†’ ë¶ˆí•„ìš” íŒŒì¼ ì œê±°/ê²½ë¡œ ì •ë¦¬

ë©”ëª¨
- ë£¨íŠ¸ì˜ êµ¬(æ—§) `cc-webapp/current_openapi.json`ëŠ” ì œê±° ì™„ë£Œ. ê¸°ì¤€ íŒŒì¼ì€ ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ ìˆ˜ì¶œëœ `current_openapi.json`ì„.
- OpenAPI ìˆ˜ì¶œ ìŠ¤í¬ë¦½íŠ¸ëŠ” ìºì‹œ ë¬´íš¨í™” ë¡œì§ì„ í¬í•¨í•¨. ê·¸ë˜ë„ ë°˜ì˜ì´ ì—†ìœ¼ë©´ ì»¨í…Œì´ë„ˆ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¬ê¸°ë™.

### 8.3 Crash ì„¸ì…˜ ìƒíƒœ ë° ê²€ì¦ (ì‹ ê·œ)

ê°œìš”
- Crash ê²Œì„ì´ Redis ê¸°ë°˜ ìƒíƒœful ì„¸ì…˜ìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤.
- ë‹¨ì¼ í™œì„± ì„¸ì…˜ ê°€ë“œ(ì¤‘ë³µ ë² íŒ… ì°¨ë‹¨), TTL ê¸°ë°˜ ë§Œë£Œ, profit-only ì •ì‚°(ë² íŒ… ì›ê¸ˆì€ ì„ ì°¨ê°) ì •ì±…ì„ ì ìš©í–ˆìŠµë‹ˆë‹¤.
- ì£¼ìš” ì•„í‹°íŒ©íŠ¸
	- ì„œë¹„ìŠ¤: `cc-webapp/backend/app/services/crash_session.py`
	- ë¼ìš°í„° ì—°ë™: `cc-webapp/backend/app/routers/games.py` (bet/cashout)
	- Alembic ì´ˆì•ˆ: `cc-webapp/backend/alembic/versions/20250808_add_crash_tables.py`
	- ì°¸ì¡° SQL: `data/init/010_crash_sessions.sql`
	- BE í…ŒìŠ¤íŠ¸: `cc-webapp/backend/app/tests/test_crash_session_lifecycle.py`
	- FE ìŠ¤ëª¨í¬ í˜ì´ì§€: `cc-webapp/frontend/app/api/smoke-refresh/page.tsx`

ì—”ë“œí¬ì¸íŠ¸ ìš”ì•½
- POST `/api/games/crash/bet` â†’ ì„¸ì…˜ ì‹œì‘, ì‘ë‹µì— `game_id`(=session_id)
- POST `/api/games/crash/cashout` â†’ í™œì„± ì„¸ì…˜ í˜„ê¸ˆí™”, ì´ìµë§Œ ê°€ì‚°

ì˜¤ë¥˜ ì½”ë“œ
- 409: í™œì„± ì„¸ì…˜ì´ ì´ë¯¸ ì¡´ì¬(ì¤‘ë³µ ë² íŒ…)
- 404: í˜„ê¸ˆí™” ì‹œ í™œì„± ì„¸ì…˜ ì—†ìŒ
- 503: ì„¸ì…˜ ì €ì¥ì†Œ(ì˜ˆ: Redis) ì‚¬ìš© ë¶ˆê°€

ê²€ì¦(ìš”ì•½)
- bet í˜¸ì¶œë¡œ `game_id` ìˆ˜ì‹  â†’ ë™ì¼ í† í°ìœ¼ë¡œ cashout í˜¸ì¶œ â†’ ì”ì•¡ì´ profit ë§Œí¼ ì¦ê°€í•˜ëŠ”ì§€ í™•ì¸
- í™œì„± ì„¸ì…˜ ìƒíƒœì—ì„œ bet ì¬í˜¸ì¶œ ì‹œ 409 ë°˜í™˜ í™•ì¸
- cashout í›„ ê°™ì€ ì„¸ì…˜ ì¬-cashout ì‹œ 404 ë°˜í™˜ í™•ì¸

Update Log (2025-08-08):
- ì„œë²„ ë¶€íŒ…/í—¬ìŠ¤ ì²´í¬ í†µê³¼ (/health OK)
- OpenAPI ì¬ìƒì„± ì™„ë£Œ (`backend/current_openapi.json`)
 - ë£¨íŠ¸ `cc-webapp/current_openapi.json` ì œê±° ì™„ë£Œ (ì¤‘ë³µ ì†ŒìŠ¤ ì •ë¦¬)
 - ì»¨í…Œì´ë„ˆ ë‚´ smoke test (signupâ†’loginâ†’gamesâ†’rps) í†µê³¼
 - games í…Œì´ë¸” ìƒì„±(ì—†ì„ ì‹œ) ë° ìƒ˜í”Œ seed ì ìš©
 - RPS `operation_id` ê³ ì •: `games_rps_play_v1` (POST `/api/games/rps/play`)
 - Admin ë¯¸ì…˜ CRUD ê²½ë¡œ í™•ì¸: `/api/admin/missions/`, `/api/admin/missions/{mission_id}`, `/api/admin/missions/{mission_id}/activate`ê°€ OpenAPIì— ë°˜ì˜ë¨
 - Frontend API í´ë¼ì´ì–¸íŠ¸ ì •ë ¬: ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ `/api` í”„ë¦¬í”½ìŠ¤ ê°•ì œ, í† í° ì €ì¥ `cc_auth_tokens`ë¡œ í†µí•©(ë ˆê±°ì‹œ í‚¤ ë™ê¸°í™”), ë¦¬í”„ë ˆì‹œ ì‘ë‹µ í‚¤ ë³€í˜• ëŒ€ì‘
 - Compose í—¬ìŠ¤ì²´í¬: frontend(3000) ì¶”ê°€, backend(8000/health) ìœ ì§€
 - Pytest ìŠ¤ëª¨í¬ ì¶”ê°€: auth refresh(í—¤ë”/ë°”ë””)ì™€ crash cashout(ê¸°ë³¸ ê²€ì¦) ë¹„ì •ìƒ 5xx ë°©ì§€ í™•ì¸ìš©
 - WS í´ë¼ì´ì–¸íŠ¸ ê°œì„ : tokenProvider ì§€ì›, NEXT_PUBLIC_API_URL ê¸°ë°˜ ws/wss ìë™ ì„ íƒ, heartbeat ping(ê¸°ë³¸ 30s)
 - ë£¨íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì •ë¦¬: Storybook(dev/build) ë° test:backend:smoke ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€
 - CI ì›Œí¬í”Œë¡œìš° ì‹ ì„¤: `.github/workflows/ci.yml`(frontend-tests, backend-tests)
 - FE Jest í…ŒìŠ¤íŠ¸ ì¶”ê°€: `cc-webapp/frontend/__tests__/api.refresh.test.ts` (401â†’refreshâ†’retry ì„±ê³µ/ì‹¤íŒ¨ ê²½ë¡œ)
 - Crash ì„¸ì…˜ ìƒíƒœ í†µí•©: bet/cashoutì´ Redis-backed `CrashSessionService`ë¡œ ë™ì‘(ë‹¨ì¼ í™œì„±, TTL, profit-only)
 - Alembic ì´ˆì•ˆ ì»¤ë°‹: `alembic/versions/20250808_add_crash_tables.py`
 - BE í¬ë˜ì‹œ ë¼ì´í”„ì‚¬ì´í´ í…ŒìŠ¤íŠ¸: `app/tests/test_crash_session_lifecycle.py` (í† í° ì œê³µ ì‹œ ì‹¤í–‰)
 - FE ìŠ¤ëª¨í¬ í˜ì´ì§€: `/api/smoke-refresh` ì¶”ê°€(í† í° ìë™ ë¦¬í”„ë ˆì‹œ í”Œë¡œìš° í™•ì¸)

ì—…ë°ì´íŠ¸(2025-08-10): í…ŒìŠ¤íŠ¸ ì „ìš© Compose/.env ì •ë¹„
- docker-compose.test.ymlì˜ build.dockerfile ë“¤ì—¬ì“°ê¸° ì˜¤ë¥˜ ìˆ˜ì •, backendë¥¼ idleë¡œ ë‘ê³  CIì—ì„œ exec ë°©ì‹ìœ¼ë¡œ pytest ì‹¤í–‰í•˜ë„ë¡ ë³€ê²½
- .env.testë¥¼ í…ŒìŠ¤íŠ¸ ìŠ¤íƒ ì„œë¹„ìŠ¤ëª…(postgres_test/redis_test)ì— ë§ê²Œ ì •ë ¬í•˜ê³  DATABASE_URL/REDIS ì„¤ì •ì„ ì¼ì¹˜
- postgres_testì— init ìŠ¤í¬ë¦½íŠ¸ ë§ˆìš´íŠ¸ ê²½ë¡œë¥¼ ë£¨íŠ¸ `data/init`ìœ¼ë¡œ ë³€ê²½(ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íŒŒì¼ ì°¸ì¡° ì œê±°)

### ì¶”ê°€ ì—…ë°ì´íŠ¸ (2025-08-08 ì˜¤í›„)

- í”„ë¡ íŠ¸â†”ë°±ì—”ë“œ ìŠ¤í™ ë™ê¸°í™”
	- ê²Œì„ ìš”ì²­ ìŠ¤í‚¤ë§ˆì— camelCase alias ìˆ˜ìš©: betAmount, pullCount, usePremiumCurrency, autoCashout ë“±(Pydantic v2 alias) â†’ ê¸°ì¡´ FE í˜¸ì¶œ ê·¸ëŒ€ë¡œ ì •ìƒ ì²˜ë¦¬
	- ì¸ì¦ ë¦¬í”„ë ˆì‹œ ê³„ì•½ ì¼ì¹˜: ë°±ì—”ë“œ `/api/auth/refresh`ê°€ ì´ì œ Authorization Bearerì™€ JSON body `{ refresh_token }` ëª¨ë‘ ì§€ì›, ì‘ë‹µì— refresh_token í¬í•¨(í˜¸í™˜ ì €ì¥)
	- í¬ë˜ì‹œ í˜„ê¸ˆí™” ì—”ë“œí¬ì¸íŠ¸ ê³ ë„í™”: `POST /api/games/crash/cashout` (ìš”ì²­ `{ gameId }`)ì´ Redis ì„¸ì…˜ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘. ë‹¨ì¼ í™œì„± ì„¸ì…˜ ê°€ë“œ ë° profit-only ì •ì‚° ì ìš©
	- FE í† í° ìŠ¤í† ë¦¬ì§€ ë³´ê°•: `cc_auth_tokens`(ë‹¨ì¼ í‚¤)ì™€ ë ˆê±°ì‹œ `access_token`/`refresh_token` ì–‘ìª½ì„ ì½ê³  ì €ì¥/ì‚­ì œ ë™ê¸°í™”(ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜)

- ë¬¸ì„œ/ë„êµ¬
	- OpenAPI ì¬ìˆ˜ì¶œ í•„ìš” ì‹œ `python -m app.export_openapi`ë¡œ ê°±ì‹  ê°€ëŠ¥ (ì»¨í…Œì´ë„ˆ ë‚´ë¶€)

- ìœ ì˜ì‚¬í•­
	- Crash ì„¸ì…˜ì€ Redis ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤. DB ì˜ì†í™”/ê°ì‚¬ í…Œì´ë¸”ì€ Alembic ì •ì‹í™” í›„ í™•ì¥ ì˜ˆì •

### 8.4 ì¸ì¦ í”Œë¡œìš° ë³´ê°• ë° ê²€ì¦ (2025-08-11)

ë³€ê²½ ìš”ì•½
- ë°±ì—”ë“œ í† í° ìƒì„± ë¡œì§ì— iat, jti í´ë ˆì„ ì¶”ê°€í•˜ì—¬ ë¦¬í”„ë ˆì‹œ ì‹œ í•­ìƒ ìƒˆë¡œìš´ ì•¡ì„¸ìŠ¤ í† í°ì´ ë°œê¸‰ë˜ë„ë¡ ê°œì„  (`app/services/auth_service.py`).
- í…ŒìŠ¤íŠ¸ ì¶”ê°€/ë³´ê°•:
	- `app/tests/test_auth_refresh_flow.py`: ë¦¬í”„ë ˆì‹œê°€ ìƒˆë¡œìš´ í† í°ì„ ë°˜í™˜í•˜ê³  ë³´í˜¸ ì—”ë“œí¬ì¸íŠ¸ì— ì ‘ê·¼ ê°€ëŠ¥í•œì§€, í—¤ë” alg=HS256/exp ì¡´ì¬ í™•ì¸.
	- `app/tests/test_invite_signup_login_me.py`: íšŒì›ê°€ì…â†’ë¡œê·¸ì¸â†’í”„ë¡œí•„ ì¡°íšŒ, ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸ 401, ë¡œê·¸ì¸ ì‹œ last_login ì—…ë°ì´íŠ¸ ê²€ì¦.
- í…ŒìŠ¤íŠ¸ ìŠ¤í‚¤ë§ˆ ë³´ì¥: `tests/conftest.py`ì—ì„œ `Base.metadata.create_all(bind=engine)` í˜¸ì¶œë¡œ ë¡œì»¬ SQLite í…ŒìŠ¤íŠ¸ ì‹œ í…Œì´ë¸” ìë™ ìƒì„±.

ì¶”ê°€ ë³€ê²½ (2025-08-11 ë°¤)
- ë¡œê·¸ì¸ ë½ì•„ì›ƒ ë„ì…: ìµœê·¼ ì‹¤íŒ¨ íšŸìˆ˜(ê¸°ë³¸ 5íšŒ) ì´ìƒì´ë©´ ì¼ì • ì‹œê°„(ê¸°ë³¸ 10ë¶„) 429 ë°˜í™˜. ì„±ê³µ/ì‹¤íŒ¨ ì‹œë„ëŠ” `login_attempts` í…Œì´ë¸”ì— ê¸°ë¡.
	- í™˜ê²½ë³€ìˆ˜: `LOGIN_MAX_FAILED_ATTEMPTS=5`, `LOGIN_LOCKOUT_MINUTES=10` (í•„ìš” ì‹œ ì¡°ì •)
- ë³„ì¹­ ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€: `GET /api/auth/me` â†’ ê¸°ì¡´ `GET /api/users/profile`ì™€ ë™ì¹˜(í˜„ì¬ ì‚¬ìš©ì ì •ë³´).
- í…ŒìŠ¤íŠ¸ ì¶”ê°€: `app/tests/test_auth_lockout_me_alias.py`
	- 5íšŒ ì‹¤íŒ¨ í›„ ì¶”ê°€ ì‹œë„ ì‹œ 429, ë½ì•„ì›ƒ ìœˆë„ìš° ë‚´ì˜ ì˜¬ë°”ë¥¸ ë¹„ë°€ë²ˆí˜¸ë„ 429ë¡œ ì°¨ë‹¨ë˜ëŠ” ì •ì±…ì„ ê²€ì¦.
	- `/api/auth/me`ê°€ `/api/users/profile`ê³¼ ë™ì¼ ì‚¬ìš©ì ì •ë³´ë¥¼ ë°˜í™˜í•¨ì„ ê²€ì¦.

ê²€ì¦ ê²°ê³¼
- ëŒ€ìƒ í…ŒìŠ¤íŠ¸ 5ê°œ PASS. ë¦¬í”„ë ˆì‹œ ì‘ë‹µì˜ access_tokenì´ ì´ì „ í† í°ê³¼ ë‹¬ë¼ì§€ê³ , ìƒˆë¡œìš´ í† í°ìœ¼ë¡œ `/api/users/profile` ì ‘ê·¼ 200 í™•ì¸.
- `HS256`/`exp` í´ë ˆì„ ìœ íš¨ì„± í™•ì¸, ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸ëŠ” 401, ë¡œê·¸ì¸ í›„ `/api/users/info`ì˜ `last_login` ê°’ ì¡´ì¬ í™•ì¸.
- ë ˆì´íŠ¸ë¦¬ë°‹/ë½ì•„ì›ƒ ë¯¸êµ¬í˜„(ë°˜ë³µ 401ì‹œ 429 ë¯¸ë°œìƒ) â€” í˜„ ì„¤ê³„ëŒ€ë¡œ ë™ì‘í•¨ì„ ë¬¸ì„œí™”.
 - ì—…ë°ì´íŠ¸: ì´ 7ê°œ í…ŒìŠ¤íŠ¸ PASS(ë½ì•„ì›ƒ/ë³„ì¹­ í¬í•¨). ë½ì•„ì›ƒ ì •ì±…ì— ë”°ë¼ 5íšŒ ì‹¤íŒ¨ ì´í›„ ëª¨ë“  ë¡œê·¸ì¸ ì‹œë„ëŠ” ë½ì•„ì›ƒ ì‹œê°„ ê²½ê³¼ ì „ê¹Œì§€ 429.

ìŠ¤í‚¤ë§ˆ/Alembic
- OpenAPI ìŠ¤í™ ë³€ê²½ ì—†ìŒ(í† í° í˜ì´ë¡œë“œ ë‚´ë¶€ ë³€ê²½). ì¬ìˆ˜ì¶œ ë¶ˆí•„ìš”.
- DB ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì—†ìŒ(Alembic heads ì˜í–¥ ì—†ìŒ).

OpenAPI ë™ê¸°í™”
- ì»¨í…Œì´ë„ˆ ë‚´ë¶€ `python -m app.export_openapi` ì‹¤í–‰ìœ¼ë¡œ `cc-webapp/backend/current_openapi.json` ê°±ì‹ .
- `/api/auth/me` ê²½ë¡œê°€ ìŠ¤í‚¤ë§ˆì— ë°˜ì˜ë¨ì„ í™•ì¸.

ë‹¤ìŒ ë‹¨ê³„
- í•„ìš” ì‹œ `/api/auth/me` ë³„ì¹­ ì¶”ê°€(í˜„ì¬ëŠ” `/api/users/profile`ì´ me ì—­í• ). ì¶”ê°€ ì‹œ OpenAPI/í…ŒìŠ¤íŠ¸/ë¬¸ì„œ ë™ë°˜ ì—…ë°ì´íŠ¸.
- ë ˆì´íŠ¸ë¦¬ë°‹/ë¡œê·¸ì¸ ì‹¤íŒ¨ ì¹´ìš´íŠ¸ ë° ì¿¨ë‹¤ìš´ ì •ì±… ë„ì… ê³ ë ¤(í…Œì´ë¸”: `login_attempts` í™œìš©) â€” 401 ë‚¨ë°œ ë°©ì§€.
- ì»¨í…Œì´ë„ˆ í™˜ê²½ì—ì„œì˜ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ í‘œì¤€í™”: docker-manage.ps1ë¥¼ í†µí•´ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ `pytest` ë° `alembic upgrade head` ìˆ˜í–‰.

#### Config í†µí•© ì§„í–‰ìƒí™©
- ë°œê²¬: `app/config.py`ì™€ `app/core/config.py` ê³µì¡´, ì¼ë¶€ ìœ í‹¸ ìŠ¤í¬ë¦½íŠ¸ê°€ `app.config`ì— ì˜ì¡´
- ì¡°ì¹˜: `backend/add_image_url_field.py`, `app/kafka_client.py`ë¥¼ í™˜ê²½ë³€ìˆ˜ ê¸°ë°˜ìœ¼ë¡œ ì „í™˜í•˜ì—¬ `app.config` ì˜ì¡´ ì œê±°
- ë‹¤ìŒ: ëŸ°íƒ€ì„ ì½”ë“œì˜ ì„¤ì • ì°¸ì¡°ë¥¼ `app.core.config.settings`ë¡œ í‘œì¤€í™”í•˜ê³ , `app/config.py`ëŠ” ì„ì‹œ shim í›„ ì œê±°

---

### 8.5 Games/Gacha ê²½ë¡œ í†µí•© ë° ë ˆê±°ì‹œ ì œê±° ì•ˆë‚´ (2025-08-11)

ë³€ê²½ ìš”ì•½
- ë ˆê±°ì‹œ `app/routers/gacha.py`ë¥¼ Deprecated ì²˜ë¦¬. ì£¼ì„ìœ¼ë¡œ ëª…í™•íˆ í‘œê¸°í•˜ê³ , ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ includeí•˜ì§€ ì•ŠìŒ.
- ëª¨ë‹ˆí„°ë§ ìŠ¤í¬ë¦½íŠ¸(`cc-webapp/monitoring/load_test.js`)ì˜ ê°€ì±  í˜¸ì¶œì„ `/api/gacha/pull`ì—ì„œ í†µí•© ê²½ë¡œ `/api/games/gacha/pull`ë¡œ ë³€ê²½.
- ë¦´ë¦¬ìŠ¤ ë…¸íŠ¸ì˜ ê²½ë¡œ í‘œê¸°(`/api/gacha/pull`)ë¥¼ `/api/games/gacha/pull`ë¡œ ì •ì •.

ê²€ì¦ ê²°ê³¼
- OpenAPI(`cc-webapp/backend/current_openapi.json`)ì— `/api/games/gacha/pull` ë‹¨ì¼ ê²½ë¡œë§Œ ë…¸ì¶œë¨ì„ í™•ì¸.
- ë‚´ë¶€ í…ŒìŠ¤íŠ¸ ìŠ¤ëª¨í¬ì—ì„œ `/api/games/gacha/pull` ì‘ë‹µ êµ¬ì¡°(items, balance ë“±) ì •ìƒ.
- Alembic head ì˜í–¥ ì—†ìŒ, í…ŒìŠ¤íŠ¸ ì˜í–¥ ì—†ìŒ.

ë‹¤ìŒ ë‹¨ê³„
- ë ˆê±°ì‹œ ë¼ìš°í„° íŒŒì¼(`app/routers/gacha.py`)ì€ ë³´ê´€ë§Œ í•˜ê³  í–¥í›„ ë¸Œëœì¹˜ ì •ë¦¬ ì‹œ ì™„ì „ ì œê±° ì—¬ë¶€ ê²°ì •.
- FE íƒ€ì…/í˜¸ì¶œë¶€ ì ê²€: ëª¨ë“  ê°€ì±  í˜¸ì¶œì´ `/api/games/gacha/pull`ì„ ì‚¬ìš©í•˜ë„ë¡ ì¼ê´„ í™•ì¸.
- í•„ìš” ì‹œ `python -m app.export_openapi` ì¬ìˆ˜ì¶œë¡œ ìŠ¤í‚¤ë§ˆ ìµœì‹  ìœ ì§€ ë° í”„ë¡ íŠ¸ íƒ€ì… ì¬ìƒì„±.
 - íŒ€ ì»¨íŒ í›„ ì‹¤í–‰: `app/routers/gacha.py` íŒŒì¼ ì™„ì „ ì œê±° â†’ OpenAPI ì¬ìˆ˜ì¶œ â†’ ê´€ë ¨ ë¬¸ì„œì—ì„œ ë ˆê±°ì‹œ ê²½ë¡œ ì–¸ê¸‰ ì‚­ì œ.
 - í”„ë¡ íŠ¸ íƒ€ì… ì¬ìƒì„±(ì„ íƒ): openapi-typescriptë¡œ `backend/current_openapi.json` â†’ `frontend/types/openapi.d.ts` ìƒì„± í›„ ë¹Œë“œ.

í”„ë¡ íŠ¸ íƒ€ì… ì¬ìƒì„± ê°€ì´ë“œ (ì„ íƒ)
- ë°©ë²•: ê°œë°œ PCì—ì„œ ì‹¤í–‰ ë˜ëŠ” í”„ë¡ íŠ¸ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ì‹¤í–‰ ê¶Œì¥
- ì˜ì¡´ì„±: `openapi-typescript` (devDependency)
- ì‹¤í–‰ ì˜ˆì‹œ (ë¬¸ì„œìš©):
  1) í”„ë¡ íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ devDependency ì„¤ì¹˜
	  - npm i -D openapi-typescript
  2) íƒ€ì… ìƒì„±
	  - npx openapi-typescript ../backend/current_openapi.json -o types/openapi.d.ts
  3) import ê²½ë¡œ ì˜ˆì‹œ: `import type { paths } from "@/types/openapi";`

## 9. Actionable TODOs (2025-08-08)

 - [x] OpenAPI ì¬ìˆ˜ì¶œ í›„ ì»¤ë°‹(í”„ë¡ íŠ¸/ë¬¸ì„œ ë°˜ì˜)
 - [x] í”„ë¡ íŠ¸ ë ˆê±°ì‹œ API í´ë¼ì´ì–¸íŠ¸(`frontend/utils/api.ts`) `/api` í”„ë¦¬í”½ìŠ¤ ë° ë¦¬í”„ë ˆì‹œ ê³„ì•½ ì •ë ¬, í† í° ì €ì¥ í†µí•©(`cc_auth_tokens`)
 - [x] ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ë£¨íŠ¸ `package.json` scripts ì¤‘ë³µ ì •ë¦¬/ë³‘í•©(dev/build/lint/storybook í†µí•©)

---

### 2025-08-12 (ë°¤) - ë¬¸ì„œ ì •ë¦¬/ê°€ì´ë“œ ë³´ê°•

- 20250729-ê°€ì´ë“œ006.md ë³´ê°•:
	- OpenAPI ì¬ìˆ˜ì¶œ ì ˆì°¨(ì»¨í…Œì´ë„ˆ ë‚´ `python -m app.export_openapi`).
	- ê°€ì±  ì‘ë‹µ ìŠ¤í‚¤ë§ˆ ì˜ˆì‹œ(animation_type, psychological_message í¬í•¨) ìš”ì•½.
	- CI í¬í•¨ í…ŒìŠ¤íŠ¸ ì•ˆë‚´: `test_gacha_distribution.py`, `test_auth_refresh_rotate_revoke.py` ë° RNG ì‹œë“œ ê¶Œì¥.
	- ê²Œì„ ì„¤ê³„ ìš”ì•½: í”¼í‹°(90), ê·¼ì ‘ì‹¤íŒ¨(near-miss) ê°€ì¤‘, íˆìŠ¤í† ë¦¬ ê°ì‡ , 10ì—°ì°¨ í• ì¸.

ê²€ì¦ ê²°ê³¼
- ì½”ë“œ ë³€ê²½ ì—†ìŒ(ë¬¸ì„œë§Œ ìˆ˜ì •). Alembic heads ë‹¨ì¼ ìœ ì§€(N/A). ê¸°ì¡´ í…ŒìŠ¤íŠ¸ ì˜í–¥ ì—†ìŒ.

ë‹¤ìŒ ë‹¨ê³„
- CI ì›Œí¬í”Œë¡œì— ì‹ ê·œ í…ŒìŠ¤íŠ¸ 2ì¢…ì„ ì •ì‹ í¬í•¨(í”Œë ˆì´í¬ ì™„í™”ìš© ì‹œë“œ ì˜µì…˜ ê²€í† ).
- ì´í›„ ì½”ë“œ ë³€ê²½ ì‹œ OpenAPI ì¬ìˆ˜ì¶œ ìˆ˜í–‰ ë° docs ë§í¬ ì—…ë°ì´íŠ¸.
- ê°€ì±  í™•ë¥ /ê°€ì¤‘ íŒŒë¼ë¯¸í„°ë¥¼ ì„¤ì •í™”í•˜ê³  ë¬¸ì„œì™€ ë™ê¸°í™”.
 - [x] Crash ê²Œì„ ì„¸ì…˜ ìƒíƒœ ê´€ë¦¬ 1ë‹¨ê³„(ì§„í–‰ ì¤‘ ê²Œì„, ë² íŒ…ì•¡, ë°°ìœ¨) ë° ìºì‹œì•„ì›ƒ ì •ì‚° ë¡œì§(Profit-only) êµ¬í˜„
	 - ì™„ë£Œ: Redis ê¸°ë°˜ `app/services/crash_session.py` (start/get/update_multiplier/cashout/expire)
	 - ì™„ë£Œ: ë¼ìš°í„° ì—°ë™ `/api/games/crash/bet`, `/api/games/crash/cashout`
	 - ì§„í–‰: SQL ìŠ¤ì¼€ì¹˜ `data/init/010_crash_sessions.sql` (crash_sessions / crash_bets)
 - [ ] Crash ì„¸ì…˜ DB ì˜ì†í™” ë° Alembic ì •ì‹í™”(ëª¨ë¸ ì •í•©/ì œì•½/ì¸ë±ìŠ¤)
	- í˜„í™©: `20250808_add_crash` ì ìš© ì™„ë£Œ, ë‹¤ì¤‘ head ë³‘í•© í•„ìš”
	- ë‹¤ìŒ: ë¸Œëœì¹˜ ë„¤ì´ë° í™•ì¸ í›„ `alembic heads` ê²€í†  â†’ `alembic merge` ì „ëµ ìˆ˜ë¦½
 - [ ] ì‚¬ìš©ì í†µê³„ íƒ€ì…(`frontend/types/*`)ê³¼ ë°±ì—”ë“œ ì‘ë‹µ ìŠ¤í‚¤ë§ˆ ì¼ì¹˜í™”(ëˆ„ë½ í•„ë“œ/ë„¤ì´ë° í™•ì¸)
 - [x] í”„ë¡ íŠ¸ WebSocket í´ë¼ì´ì–¸íŠ¸ ì¶”ê°€(`/ws/notifications/{user_id}` ì—°ê²°, í† í° ì¸ì¦/ì¬ì—°ê²° ì²˜ë¦¬)
 	- ê°œì„ : `frontend/utils/wsClient.ts` (ìë™ ì¬ì—°ê²°/ì§€ìˆ˜ ë°±ì˜¤í”„/í† í° ì¿¼ë¦¬ ì§€ì› + tokenProvider + ws/wss ìë™ + heartbeat)
 - [x] ë°±ì—”ë“œ í…ŒìŠ¤íŠ¸: `/api/auth/refresh`(body/Authorization ì–‘ê²½ë¡œ) ë° `/api/games/crash/cashout` ìŠ¤ëª¨í¬ ì¶”ê°€(pytest)
 - [x] í”„ë¡ íŠ¸ í…ŒìŠ¤íŠ¸: apiClient 401â†’refreshâ†’ì¬ì‹œë„ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸(Jest/RTL)

ì¶”ê°€ ì—…ë°ì´íŠ¸ (2025-08-12 ë°¤) â€” í…ŒìŠ¤íŠ¸ ë³´ê°•
- BE í…ŒìŠ¤íŠ¸ ì¶”ê°€:
	- `app/tests/test_gacha_distribution.py`: 1000 pulls ìƒ˜í”Œì—ì„œ Common/Rare/Epic ë¹„ìœ¨ì´ ì„œë¹„ìŠ¤ ê¸°ë³¸ í…Œì´ë¸”(near-miss ë§¤í•‘ ë°˜ì˜) ëŒ€ë¹„ Â±5% ì•ˆì— ë“¤ì–´ì˜¤ëŠ”ì§€ ê²€ì¦
	- `app/tests/test_auth_refresh_rotate_revoke.py`: refresh í˜¸ì¶œ ì‹œ ì•¡ì„¸ìŠ¤ í† í° ê°±ì‹ /íšŒì „, logoutìœ¼ë¡œ refresh íê¸°, logout-allë¡œ ì „ì²´ íê¸° íë¦„ ê²€ì¦
- OpenAPI ë³€ê²½ ì—†ìŒ(í…ŒìŠ¤íŠ¸ë§Œ ì¶”ê°€). Alembic ì˜í–¥ ì—†ìŒ.
 - [x] ë¬¸ì„œ ê°±ì‹ : ì¸ì¦ ë¦¬í”„ë ˆì‹œ ê³„ì•½, ê²Œì„ API(crash bet/cashout) ìŠ¤í™, í† í° ì €ì¥ ì •ì±…(ì‹ ê·œ/ë ˆê±°ì‹œ í˜¸í™˜)
- [ ] CI/CD íŒŒì´í”„ë¼ì¸ ì„¤ì •(í”„ë¡ íŠ¸/ë°±ì—”ë“œ í…ŒìŠ¤íŠ¸ ì¡ êµ¬ë¶„) â€” ì›Œí¬í”Œë¡œìš° íŒŒì¼ ì¡´ì¬, alembic upgrade head + pytest ë‹¨ê³„ ì¶”ê°€ í•„ìš”
 - [x] docker-compose í—¬ìŠ¤ì²´í¬ ì ê²€(backend 8000, frontend 3000)
 - [ ] Alembic ë§ˆì´ê·¸ë ˆì´ì…˜ ì •ì‹í™”(ê²Œì„/ì•¡ì…˜/ë³´ìƒ í…Œì´ë¸”), ì‹œë“œ ìŠ¤í¬ë¦½íŠ¸ ì •ë¦¬
	- í˜„í™©: ë‹¤ì¤‘ head ì¡´ì¬, head ì „ì²´ ì—…ê·¸ë ˆì´ë“œëŠ” ë³´ë¥˜ ì¤‘
	- ë‹¤ìŒ: ë³‘í•© ë¦¬ë¹„ì „ ì‘ì„± í›„ CIì— `alembic upgrade head` ê°€ëŠ¥ ìƒíƒœë¡œ ë³µêµ¬

---

## 10. Admin ê¸°ëŠ¥ ì»¤ë²„ë¦¬ì§€ ë° ë³´ì™„ ê³„íš (2025-08-08)

### ì»¤ë²„ë¦¬ì§€ ìš”ì•½

- User info
	- ë³´ìœ : GET /api/admin/stats, AdminService(list_users/get_user_details/get_user_activities/get_user_rewards)
	- ë¯¸ë¹„: ì‚¬ìš©ì ëª©ë¡/ìƒì„¸/í™œë™/ë³´ìƒ ì¡°íšŒìš© Admin ì—”ë“œí¬ì¸íŠ¸

- Rewards(ë³´ìƒ)
	- ë³´ìœ : POST /api/rewards/distribute, GET /api/rewards/users/{id}/rewards
	- ë¯¸ë¹„: ëŒ€ëŸ‰ì§€ê¸‰, ë³´ìƒ ì·¨ì†Œ, í…œí”Œë¦¿ CRUD

- Events
	- ë³´ìœ (ì‚¬ìš©ì í”Œë¡œìš°): ì´ë²¤íŠ¸ ì¡°íšŒ/ì°¸ì—¬/ì§„í–‰/ìˆ˜ë ¹
	- ë¯¸ë¹„(ê´€ë¦¬ì CRUD): ë¦¬ìŠ¤íŠ¸/ìƒì„±/ìˆ˜ì •/ì‚­ì œ/í¼ë¸”ë¦¬ì‹œ, ë¯¸ì…˜ ì •ì˜ CRUD

- Notifications(ì•Œë¦¼)
	- ë³´ìœ : WS ì¸í”„ë¼(/ws/notifications/{user_id})
	- ë¯¸ë¹„: Admin ë°œì†¡/ë¸Œë¡œë“œìºìŠ¤íŠ¸/ìŠ¤ì¼€ì¤„ API

- User edit(í¸ì§‘/ê³„ì •ê´€ë¦¬)
	- ë³´ìœ : ban/unban, tokens/add
	- ë¯¸ë¹„: PATCH í¸ì§‘, ê¸°íƒ€ í†µí™”(gems/gold), ê· í˜• ì„¤ì •, ë¹„ë²ˆë¦¬ì…‹, ì–´ëœíŠ¸ ì ê¸ˆí•´ì œ

- Security/Anomaly(ë³´ì•ˆ/ì´ìƒíƒì§€)
	- ë³´ìœ : ì„¸ê·¸ë¨¼íŠ¸/íŠ¸ë˜í‚¹/ë¶„ì„ ê¸°ë°˜(ê¸°ì´ˆ)
	- ë¯¸ë¹„: ì´ìƒëª©ë¡/ìˆ˜ë™ í”Œë˜ê·¸/ë£° ì¡°íšŒÂ·ìˆ˜ì •/ì¿¨ë‹¤ìš´ ì¡°ì¹˜

### ì œì•ˆ ì—”ë“œí¬ì¸íŠ¸(ìµœì†Œ ê³„ì•½)

- GET /api/admin/users?search=&page=&page_size=
- GET /api/admin/users/{id}
- GET /api/admin/users/{id}/activities?page=&page_size=
- PATCH /api/admin/users/{id}
- POST /api/admin/rewards/grant-bulk
- Admin Events CRUD: POST/PUT/DELETE /api/admin/events, POST /api/admin/events/{id}/publish
- Admin Notifications: POST /api/admin/notifications/send, POST /api/admin/notifications/broadcast

### êµ¬í˜„ ìš°ì„ ìˆœìœ„

1) Admin ì‚¬ìš©ì ëª©ë¡/ìƒì„¸/í¸ì§‘
2) Admin Events CRUD (+ ë¯¸ì…˜ í…œí”Œë¦¿ì´ í•„ìš”í•˜ë©´ ì´ì–´ì„œ)
3) Admin Notifications ë°œì†¡/ë¸Œë¡œë“œìºìŠ¤íŠ¸
4) Rewards ëŒ€ëŸ‰ì§€ê¸‰/í…œí”Œë¦¿
5) Security/Anomaly íŒ¨ë„ìš© ê¸°ì´ˆ API

---

ì¶”ê°€ ì—…ë°ì´íŠ¸ (Crash persistence & debug)

- Crash ì„¸ì…˜ DB ì˜ì†í™”(ì´ˆê¸°):
	- bet ì‹œ crash_sessionsì— active row ìƒì„±(external_session_id, user_id, game_id, bet_amount)
	- cashout ì‹œ í•´ë‹¹ row ì—…ë°ì´íŠ¸(status=cashed, cashout_multiplier, payout_amount, cashed_out_at)
- ë””ë²„ê·¸ ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€: GET /api/games/crash/debug/current
	- ì‘ë‹µ: { available: bool, session: object|null }
	- í˜„ì¬ ì‚¬ìš©ì ë²”ìœ„ì—ì„œ Redis ì„¸ì…˜ ìƒíƒœ í™•ì¸ìš© (ê°œë°œ/QA ì „ìš©)
- ê²€ì¦ íŒ:
	- bet â†’ debugì—ì„œ session í™•ì¸ â†’ cashout â†’ debugì—ì„œ ì„¸ì…˜ ì—†ìŒ í™•ì¸
	- DBì˜ crash_sessions í…Œì´ë¸”ì—ì„œ external_session_idê°€ ì‘ë‹µì˜ game_idì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸

	---

	## 11. ë”°ë¼í•˜ê¸° ì²´í¬ë¦¬ìŠ¤íŠ¸ (ì‹¤í–‰ ê°€ì´ë“œ)

	ì•„ë˜ ìˆœì„œë¡œ ìˆ˜í–‰í•˜ë©´ ë¡œì»¬ì—ì„œ ë¹ ë¥´ê²Œ ì „ì²´ íë¦„ì„ ê²€ì¦í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

	1) ì»¨í…Œì´ë„ˆ/ì„œë¹„ìŠ¤ ê¸°ë™
	- Docker Composeë¡œ ë°±ì—”ë“œ/DB/Redisë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. (í”„ë¡œì íŠ¸ ë£¨íŠ¸)
	- PowerShell
		```powershell
		.\docker-manage.ps1 start --tools
		.\docker-manage.ps1 status
		```

	2) ë§ˆì´ê·¸ë ˆì´ì…˜ & ì‹œë“œ
	- Alembic ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì ìš©í•©ë‹ˆë‹¤. (ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ë˜ëŠ” í¸ì˜ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©)
	- ê¸°ë³¸ ê²Œì„ ì‹œë“œ(`data/init/015_seed_games.sql`)ë¥¼ ì ìš©í•©ë‹ˆë‹¤.

### [2025-08-09] í…ŒìŠ¤íŠ¸/ë§ˆì´ê·¸ë ˆì´ì…˜ ì•ˆì •í™” ìŠ¤ëƒ…ìƒ·

### [2025-08-10] ë³€ê²½ ìš”ì•½/ê²€ì¦/ë‹¤ìŒ ë‹¨ê³„ (mini runbook)

- ë³€ê²½ ìš”ì•½
	- backend í…ŒìŠ¤íŠ¸ì— ìµœì†Œ ìŠ¤ëª¨í¬/CRUD/Kafka-peek ì»¤ë²„ë¦¬ì§€ ì¶”ê°€: `app/tests/test_user_journey.py`
	- ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ Alembic `upgrade head` ì‹¤í–‰, ë‹¨ì¼ head ìœ ì§€ í™•ì¸, OpenAPI ì¬ìˆ˜ì¶œ

- ê²€ì¦ ê²°ê³¼
	- `docker exec cc_backend pytest -q app/tests/test_user_journey.py` â†’ PASS (3 í…ŒìŠ¤íŠ¸ í†µê³¼)
	- `docker exec cc_backend alembic heads` â†’ ë‹¨ì¼ head: `20250810_align_users`
	- `python -m app.export_openapi` â†’ `current_openapi.json` ê°±ì‹  ì™„ë£Œ, í•µì‹¬ ë¼ìš°í„° ì •í•© ìœ ì§€

- ë‹¤ìŒ ë‹¨ê³„
	- Kafka roundtrip ì•ˆì •í™”: buffer ê´€ì°° ê¸°ë°˜ í…ŒìŠ¤íŠ¸ ë˜ëŠ” debug/peek ê¸°ë°˜ ë‹¨ì •ìœ¼ë¡œ ì „í™˜ ë° CI ê²©ë¦¬ í† í”½ ë„ì…
	- CIì— Alembic history ë° ëª…ì‹œì  downgrade/upgrade ë‹¨ê³„ ì¶”ê°€, ì‹¤íŒ¨ ì‹œ ë¹ ë¥¸ í”¼ë“œë°±
	- ì¤‘ë³µ/ë ˆê±°ì‹œ í…ŒìŠ¤íŠ¸ ì •ë¦¬(ì´ì¤‘ ê²½ë¡œ tests/tests/* ì œê±°, import mismatch í•´ê²°) í›„ ì „ì²´ ìŠ¤ìœ„íŠ¸ ê·¸ë¦°í™”

- ë³€ê²½ ìš”ì•½
	- git: ë¯¼ê°íŒŒì¼ token.json ì €ì¥ì†Œ ì¶”ì  í•´ì œ ë° .gitignore ì¶”ê°€
	- pytest: ìˆ˜ì§‘ ë²”ìœ„ë¥¼ `cc-webapp/backend/app/tests`ë¡œ ê³ ì •, legacy ë””ë ‰í„°ë¦¬/íŒŒì¼ ë¬´ì‹œ ì„¤ì • ì ìš©
	- alembic: ë¹„ì–´ìˆëŠ”/ì¤‘ë³µ ë§ˆì´ê·¸ë ˆì´ì…˜ ì •ë¦¬, crash ê´€ë ¨ ë¦¬ë¹„ì „ ë©”íƒ€ë°ì´í„° ë³´ì™„
		- ì œê±°: `alembic/versions/create_events_missions_tables.py` (ì¤‘ë³µ ì •ì˜ ì œê±°)
		- ë³´ì™„: `20250808_add_crash_tables.py`, `20250808b_harden_crash_and_indexes.py`ì— revision/depends ë©”íƒ€ ì¶”ê°€(placeholder no-op)
		- í™•ì¸: í˜„ì¬ ë‹¨ì¼ head = `f79d04ea1016`

- ê²€ì¦
	- ì»¨í…Œì´ë„ˆ ë‚´ë¶€ í…ŒìŠ¤íŠ¸: `pytest -q app/tests` â†’ 2 passed, 41 warnings
	- Alembic: `alembic heads` â†’ `f79d04ea1016 (head)` / `alembic upgrade head` ì •ìƒ

- ë‹¤ìŒ ë‹¨ê³„
	- í•„ìš” ì‹œ crash í…Œì´ë¸” ì‹¤ì œ ìŠ¤í‚¤ë§ˆë¥¼ ìœ„ placeholder ë¦¬ë¹„ì „ì— êµ¬í˜„(ë˜ëŠ” ì‹ ê·œ ë¦¬ë¹„ì „ ì¶”ê°€)
	- Pydantic v2 ê²½ê³  ë° FastAPI lifespan ì „í™˜ ë“± deprecation ëŒ€ì‘
	- í”„ë¡ íŠ¸ íƒ€ì…-API ì •í•©ì„± ì ê²€ ë° ì‹œë“œ ìŠ¤í¬ë¦½íŠ¸ ê²€í† 

	---
	## 12. ì•¼ê°„ ì§„í–‰ìƒí™© ì—…ë°ì´íŠ¸ (2025-08-08)

	ìš”ì•½
	- Config shim ì•ˆì •í™”: `app/config.py`ë¥¼ `app.core.config.settings` ìœ„ì„í˜•ìœ¼ë¡œ ì •ë¦¬í•˜ê³  ì¤‘ë³µ/ë¬¸ë²• ì˜¤ë¥˜ ì œê±°. uvicorn ë¦¬ë¡œë“œ ì˜¤ë¥˜ í•´ì†Œ.
	- í† í° ìë™ ë°œê¸‰ í…ŒìŠ¤íŠ¸í™”: `app/tests/conftest.py`ì— `auth_token` í”½ìŠ¤ì²˜ ì¶”ê°€(ì—†ìœ¼ë©´ ìë™ íšŒì›ê°€ì…/ë¡œê·¸ì¸). í™˜ê²½ ë³€ìˆ˜ ì—†ì´ë„ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥.
	- ë¼ì´í”„ì‚¬ì´í´ í…ŒìŠ¤íŠ¸ ë³´ê°•: `test_crash_session_lifecycle.py`ê°€ í”½ìŠ¤ì²˜ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ë³€ê²½. ì»¨í…Œì´ë„ˆ ë‚´ ì‹¤í–‰ PASS(ë§ˆì»¤ ê²½ê³ ë§Œ ì¡´ì¬).
	- Pytest ì„¤ì • ì •ëˆ: `pytest.ini`ì˜ testpathsë¥¼ `cc-webapp/backend/app/tests`ë¡œ êµì •.
	- Alembic ë‹¨ì¼ head ë³µêµ¬: ì¤‘ë³µ ë¦¬ë¹„ì „(`create_events_missions_tables.py`) ì œê±° í›„ ë³‘í•© ë¦¬ë¹„ì „ `f79d04ea1016` ìƒì„±. `alembic upgrade head` ì •ìƒ ë™ì‘, `alembic heads` ë‹¨ì¼ head í™•ì¸.

	ê²€ì¦
	- ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ì‚¬ìš©ì ìƒì„±â†’ë¡œê·¸ì¸â†’JWT í™•ë³´â†’í¬ë˜ì‹œ ë¼ì´í”„ì‚¬ì´í´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰, 2ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼ í™•ì¸.
	- `docker exec cc_backend alembic heads` ê²°ê³¼: `f79d04ea1016 (head)` í•˜ë‚˜ë§Œ í‘œì‹œ.

	ë‹¤ìŒ ë‹¨ê³„
	- Pytest ë§ˆì»¤ ê²½ê³  ì œê±°: `pytest-order` ë„ì… ë˜ëŠ” `@order` ë§ˆì»¤ ì œê±° ì¤‘ ì„ íƒ.
	- ëŸ°íƒ€ì„ ì „ì—­ import í‘œì¤€í™”: `from app.core.config import settings`ë¡œ ì •ë¦¬ ì™„ë£Œë˜ë©´ `app/config.py` shim ì œê±°.
	- CIì—ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜ ë‹¨ê³„ í™œì„±í™”: `alembic upgrade head`ë¥¼ íŒŒì´í”„ë¼ì¸ì— í¬í•¨í•´ ìŠ¤í‚¤ë§ˆ ë“œë¦¬í”„íŠ¸ ë°©ì§€.
	- PowerShell (ì˜ˆì‹œ)
		```powershell
		# ë§ˆì´ê·¸ë ˆì´ì…˜
		docker exec cc_backend alembic upgrade head

		# ì‹œë“œ (psql ì‚¬ìš© ì˜ˆì‹œ: ì»¨í…Œì´ë„ˆ/ë¡œì»¬ í™˜ê²½ì— ë§ê²Œ ì¡°ì •)
		docker exec -i cc_postgres psql -U cc_user -d cc_webapp -f /data/init/015_seed_games.sql
		```

	3) OpenAPI ê°±ì‹  í™•ì¸ (ì„ íƒ)
	- ìŠ¤í‚¤ë§ˆ ìºì‹œ ë¬´íš¨í™” í›„ ì¬ìˆ˜ì¶œí•˜ê³ , ì‹ ê·œ ê²½ë¡œ ë°˜ì˜ì„ ì ê²€í•©ë‹ˆë‹¤.
	- PowerShell
		```powershell
		docker exec cc_backend python -m app.export_openapi
		docker exec cc_backend cmd /c type current_openapi.json | powershell -Command "$input | Select-String 'admin/crash/sessions' -SimpleMatch"
		```

	4) ê´€ë¦¬ì ì ê²€
	- Admin Crash Audit: `GET /api/admin/crash/sessions?limit=10`
	- Rewards Bulk: `POST /api/admin/rewards/grant-bulk`
	- WS Broadcast: `POST /api/admin/notifications/broadcast`

	5) í¬ë˜ì‹œ íë¦„ ìŠ¤ëª¨í¬
	- (ì‚¬ìš©ì í† í°ìœ¼ë¡œ) `POST /api/games/crash/bet` â†’ `GET /api/games/crash/debug/current` â†’ `POST /api/games/crash/cashout`
	- ì—„ê²© ëª¨ë“œ í•„ìš” ì‹œ: ë°±ì—”ë“œ í™˜ê²½ë³€ìˆ˜ `CRASH_DB_STRICT=1`

	6) í…ŒìŠ¤íŠ¸ ì‹¤í–‰
	- ë°±ì—”ë“œ: ìŠ¤ëª¨í¬/í¬ë˜ì‹œ/ë¦¬í”„ë ˆì‹œ í…ŒìŠ¤íŠ¸ (CIì™€ ë™ì¼ êµ¬ì„±)
	- PowerShell
		```powershell
		docker exec cc_backend pytest -q app/tests/test_auth.py -q || $true
		docker exec cc_backend pytest -q app/tests/test_crash_edge_cases.py -q || $true
		docker exec cc_backend pytest -q app/tests/test_crash_session_lifecycle.py -q || $true
		```

	7) CI ì°¨ë‹¨ ìŠ¤ìœ„ì¹˜ (ì„ íƒ)
	- í¬ë˜ì‹œ ê´€ë ¨ í…ŒìŠ¤íŠ¸ë¥¼ ì°¨ë‹¨(Blocking)í•˜ë ¤ë©´ íŒŒì´í”„ë¼ì¸ì— `CI_CRASH_BLOCKING=1` ì¶”ê°€

	ë©”ëª¨
	- ë¡œì»¬ ê°œë°œ ì„±ëŠ¥ì„ ìœ„í•´ ê¸°ë³¸ì€ ë¹„ì—„ê²© ëª¨ë“œì´ë©°, ìš´ì˜/ìŠ¤í…Œì´ì§€ì—ëŠ” `CRASH_DB_STRICT=1` ê¶Œì¥
	- `/docs`ì—ì„œ Rewards/Games ì¤‘ë³µ ì„¹ì…˜ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê³ , ì¤‘ë³µ ì‹œ ë¼ìš°í„° íƒœê·¸ ì„¤ì •ì„ ì¬ê²€í† í•˜ì„¸ìš”

í˜„ì¬ ì™„ë£Œë„(ì¶”ì •)

ì „ì²´: ì•½ 70â€“75%
ê·¼ê±° ìš”ì•½:
ë°±ì—”ë“œ API/ì¸ì¦/í¬ë˜ì‹œ ë¼ì´í”„ì‚¬ì´í´: 85â€“90% (í—¬ìŠ¤ ì²´í¬ OK, íšŒì›ê°€ì…/ë¡œê·¸ì¸ OK, í† í° ê¸°ë°˜ í…ŒìŠ¤íŠ¸ PASS, Alembic ë‹¨ì¼ head ë³µêµ¬)
DB/ë§ˆì´ê·¸ë ˆì´ì…˜: 80% (ì¤‘ë³µ head í•´ê²°Â·merge ì ìš©, upgrade head ê°€ëŠ¥ ìƒíƒœ)
í”„ë¡ íŠ¸â†”ë°±ì—”ë“œ API ê³„ì•½/ìŠ¤ëª¨í¬: 60â€“65% (OpenAPI ìµœì‹ í™”, ê¸°ë³¸ ìŠ¤ëª¨í¬/í† í° ë¦¬í”„ë ˆì‹œ íë¦„ ë¬¸ì„œí™”; ì£¼ìš” UI/í”Œë¡œìš° ì „ë©´ ì—°ë™ì€ ë‚¨ìŒ)
ì¸í”„ë¼/CI: 60â€“70% (ë„ì»¤ í—¬ìŠ¤ì²´í¬/ì»¨í…Œì´ë„ˆ OK, CIì— ë§ˆì´ê·¸ë ˆì´ì…˜ ë‹¨ê³„ ìƒì‹œ í™œì„±í™” í•„ìš”)
ê³ ê¸‰ ê¸°ëŠ¥(í¼ìŠ¤ë„ë¼ì´ì œì´ì…˜/ì•Œë¦¼ ìŠ¤ì¼€ì¤„ë§/ë¶„ì„): 30â€“40% (ì„¤ê³„/ê¸°ë³¸ ê³¨ê²© ì¼ë¶€, ìš´ì˜ìˆ˜ì¤€ ì™„ì„±ì€ ë¯¸ì™„)
ë¹ ë¥´ê²Œ 90%ê¹Œì§€ ì˜¬ë¦¬ë ¤ë©´

CIì— alembic upgrade head ì¶”ê°€ ë° ìŠ¤í‚¤ë§ˆ ê²€ì¦ ê³ ì •.
í”„ë¡ íŠ¸ ì£¼ìš” í™”ë©´(Shop/BattlePass/Crash)ê³¼ ë°±ì—”ë“œ API ìµœì¢… ê²°ì„  ë° E2E ìŠ¤ëª¨í¬.
ë‚¨ì€ ë§ˆì»¤ ê²½ê³ /í…ŒìŠ¤íŠ¸ ì•ˆì •í™”ì™€ ì„¤ì • import í‘œì¤€í™”(app.core.config.settingsë¡œ í†µì¼).



---------------------ì—­í• 

ë‹¹ì‹ ì€ Casino-Club F2P í”„ë¡œì íŠ¸ì˜ ë¦¬ë“œ ê°œë°œì/ì•„í‚¤í…íŠ¸ë‹¤. ì•ˆì •ì„±, ì¼ê´€ì„±, ì¤‘ë³µ ì œê±°, í…ŒìŠ¤íŠ¸ ê·¸ë¦°ì„ ìµœìš°ì„ ìœ¼ë¡œ ì§„í–‰í•œë‹¤.
í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸

ìŠ¤íƒ: FastAPI(Python), Next.js(React), PostgreSQL, Redis, Kafka
ì‹¤í–‰: docker-compose í•„ìˆ˜, ë£¨íŠ¸ì˜ docker-manage.ps1 ì‚¬ìš©
ë°±ì—”ë“œ ë² ì´ìŠ¤ URL: http://localhost:8000
DB ë§ˆì´ê·¸ë ˆì´ì…˜: Alembic ë‹¨ì¼ head ìœ ì§€ (í˜„ì¬ head: f79d04ea1016)
ì„¤ì • í‘œì¤€: from app.core.config import settings (app/config.pyëŠ” ì„ì‹œ shim, í™•ì¥ ê¸ˆì§€)
í…ŒìŠ¤íŠ¸ ê²½ë¡œ: cc-webapp/backend/app/tests (pytest.ini ë°˜ì˜)
JWT í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜: app/tests/conftest.pyì˜ auth_token ì‚¬ìš©(ìë™ íšŒì›ê°€ì…/ë¡œê·¸ì¸)
ì ˆëŒ€ ì¤€ìˆ˜(ì¤‘ë³µ/ì˜¤ë¥˜ ë°©ì§€ ê·œì¹™)

ì¤‘ë³µ ìƒì„± ê¸ˆì§€: ë¼ìš°í„°/ì„œë¹„ìŠ¤/ìŠ¤í‚¤ë§ˆ/ë§ˆì´ê·¸ë ˆì´ì…˜/ë¬¸ì„œì— ë™ì¼ ëª©ì  íŒŒì¼ ì¶”ê°€ ê¸ˆì§€
íŠ¹íˆ Alembic revision ID ì¤‘ë³µ ìƒì„± ê¸ˆì§€; headsê°€ 2ê°œ ì´ìƒì´ë©´ merge ìƒì„±ìœ¼ë¡œ í†µí•©
ê¸°ì¡´ ë¼ìš°í„° ë³‘í•© ìƒíƒœ ìœ ì§€: games ê´€ë ¨ ì—”ë“œí¬ì¸íŠ¸ëŠ” app/routers/games.pyë§Œ ì‚¬ìš©
ì„¤ì • import í‘œì¤€í™”: app.core.config.settingsë§Œ ì‚¬ìš©; config.py ë³€ê²½ ìµœì†Œí™”(ì‚­ì œ ì˜ˆì •)
í…ŒìŠ¤íŠ¸/ë¬¸ì„œ ìµœì‹ í™” ë™ë°˜: ì½”ë“œ ë³€ê²½ ì‹œ pytest í†µê³¼ì™€ api docs/20250808.mdì— ë³€ê²½ ìš”ì•½ì„ í•¨ê»˜ ë°˜ì˜
ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œë§Œ ë¹Œë“œ/í…ŒìŠ¤íŠ¸/ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
ì‘ì—… ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

docker-manage.ps1 statusë¡œ ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
alembic headsë¡œ ë‹¨ì¼ head í™•ì¸(ì•„ë‹ˆë©´ merge ê³„íš ìˆ˜ë¦½)
/docs ë° current_openapi.json ìŠ¤í‚¤ë§ˆ ê°±ì‹  ì—¬ë¶€ í™•ì¸(í•„ìš” ì‹œ python -m app.export_openapi)
ì‘ì—… ì ˆì°¨(ë£¨í”„)

ë³€ê²½ ì˜í–¥ë„ íŒë‹¨: ì¤‘ë³µ/ì¶©ëŒ ê°€ëŠ¥ì„±, ë¼ìš°í„° ê²½ë¡œ, ìŠ¤í‚¤ë§ˆ ë³€ë™, ë§ˆì´ê·¸ë ˆì´ì…˜ í•„ìš”ì„±
ìµœì†Œ ë³€ê²½ ì›ì¹™ìœ¼ë¡œ ìˆ˜ì •(ê¸°ì¡´ íŒŒì¼ ì•ˆì—ì„œ): ì„¤ì •=app.core.config.settings, ë¼ìš°í„°=games.py
ë¹ ë¥¸ ê²€ì¦:
pytest -q app/tests (auth_token í”½ìŠ¤ì²˜ í™œìš©)
alembic upgrade head â†’ heads ë‹¨ì¼ ìœ ì§€
/docs, í•µì‹¬ API ìŠ¤ëª¨í¬ í˜¸ì¶œ(401â†’ë¡œê·¸ì¸â†’200)
ë¬¸ì„œ/ìŠ¤í‚¤ë§ˆ/ë¡œê·¸:
api docs/20250808.mdì— â€œë³€ê²½ ìš”ì•½/ê²€ì¦/ë‹¤ìŒ ë‹¨ê³„â€ 3ì¤„ ì´ìƒ ì¶”ê°€
í•„ìš” ì‹œ OpenAPI ì¬ìˆ˜ì¶œ
ì„±ê³µ ê¸°ì¤€

ë¹Œë“œ/í…ŒìŠ¤íŠ¸ ê·¸ë¦°, alembic heads ë‹¨ì¼, /health 200, /docs ì •ìƒ ë…¸ì¶œ, ì¤‘ë³µ íŒŒì¼ ì¶”ê°€ ì—†ìŒ
ê¸ˆì§€/ì£¼ì˜

ìƒˆ íŒŒì¼ëª…ì— _simple/_fixed/_temp/_v2 ë“± ì ‘ë¯¸ì‚¬ ê¸ˆì§€
Alembic íŒŒì¼ì„ ë³µì‚¬/ë¶™ì—¬ë„£ê¸° ë°©ì‹ìœ¼ë¡œ ì¤‘ë³µ ìƒì„± ê¸ˆì§€(í•­ìƒ alembic revision/merge ì‚¬ìš©)
í™˜ê²½ ë³€ìˆ˜/ì„¤ì • í‚¤ ë³€ê²½ ì‹œ ë¬¸ì„œì™€ dotenv, compose ë™ê¸°í™” í•„ìˆ˜
íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ìš°ì„ ìˆœìœ„

5xx/ìŠ¤í‚¤ë§ˆ ë¯¸ë°˜ì˜: app.openapi_schema=None í›„ ì¬ìƒì„±, ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
ì¸ì¦ ì‹¤íŒ¨: JWT_SECRET_KEY/ë§Œë£Œ ì„¤ì •, auth_token í”½ìŠ¤ì²˜ë¡œ ì¬í˜„
ë‹¤ì¤‘ head: ì¤‘ë³µ ë¦¬ë¹„ì „ íŒŒì¼ ì œê±° í›„ merge ë¦¬ë¹„ì „ ìƒì„±
ì¶œë ¥ í˜•ì‹(ê° ì‘ì—… ì¢…ë£Œ ì‹œ)

ë³€ê²½ ìš”ì•½(1-3ì¤„)
ê²€ì¦ ê²°ê³¼(í…ŒìŠ¤íŠ¸/heads/OpenAPI)
ë‹¤ìŒ ë‹¨ê³„(ë¦¬ìŠ¤íŠ¸ 2-3ê°œ)
ì´ í”„ë¡¬í”„íŠ¸ë¥¼ ì¤€ìˆ˜í•˜ë©´, ê¸°ì¡´ ì¤‘ë³µì˜¤ë¥˜ ì¬ë°œì„ ë§‰ê³ , ë‹¤ë¥¸ AIê°€ ì´ì–´ë°›ì•„ë„ ì•ˆì •ì ìœ¼ë¡œ ì‘ì—…ì„ ì§€ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


---
**[2025-08-08] ì›¹ í™•ì¸ ë° ì»¤ë°‹ ì•ˆë‚´**

ì´ ë¬¸ì„œëŠ” ìµœì‹  ì§„í–‰ìƒí™©ê³¼ ì˜¨ë³´ë”© ì •ë³´ë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. 
* ë°˜ë“œì‹œ ì»¤ë°‹í•˜ì—¬ ì›¹(ì˜ˆ: GitHub, ì‚¬ë‚´ ìœ„í‚¤ ë“±)ì—ì„œë„ í™•ì¸ ê°€ëŠ¥í•˜ë„ë¡ ìœ ì§€í•˜ì„¸ìš”. 
* ë³€ê²½ ì‹œì—ëŠ” í•­ìƒ ìµœì‹  ë‚´ìš©ì„ ë°˜ì˜í•œ í›„ ì»¤ë°‹/í‘¸ì‹œí•  ê²ƒ.

> âœ… **í˜„ì¬ ì´ ë¬¸ì„œëŠ” ì›¹ì—ì„œ í™•ì¸ ê°€ëŠ¥í•œ ìƒíƒœë¡œ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.**

---

# Casino-Club F2P í†µí•©/ì •ë¹„ ê°€ì´ë“œ (2025-08-10)

## 1. í˜„í™© ë° ë¬¸ì œ ìš”ì•½


ìµœì‹  ìƒíƒœ ìš”ì•½ (2025-08-10 ì €ë…)


ë³€ê²½ ìš”ì•½
- Alembic ë‹¨ì¼ head ìœ ì§€ ë° ì •í•© ë¦¬ë¹„ì „ ì ìš©: 20250810_align_users
- í…ŒìŠ¤íŠ¸ ì•ˆì •í™”: httpx 0.27.2ë¡œ í•€ ê³ ì • â†’ TestClient ì‹œê·¸ë‹ˆì²˜ ì˜¤ë¥˜ í•´ì†Œ
- íšŒì›ê°€ì… íë¦„ ì •ë¦¬: password_hash ì‚¬ìš© í†µì¼, rankâ†’vip_tier ë§¤í•‘ ë°˜ì˜

ê²€ì¦ ê²°ê³¼
- alembic current: 20250810_align_users (head)
- pytest: ìŠ¤ëª¨í¬/ì „ì²´ í…ŒìŠ¤íŠ¸ í†µê³¼(ê²½ê³ ë§Œ ì¡´ì¬)
- API ìŠ¤ëª¨í¬: /api/auth/signup â†’ í† í°ìœ¼ë¡œ /api/users/profile 200 í™•ì¸
- OpenAPI: ì»¨í…Œì´ë„ˆì—ì„œ python -m app.export_openapi ì‹¤í–‰, current_openapi.json ê°±ì‹  í™•ì¸

ë‹¤ìŒ ë‹¨ê³„
- Pydantic/SQLAlchemy deprecation ê²½ê³  ì •ë¦¬(ëª¨ë¸ protected_namespaces, declarative_base ê²½ë¡œ)
- CIì— alembic upgrade head ë‹¨ê³„ ì¶”ê°€í•˜ì—¬ ìŠ¤í‚¤ë§ˆ ë“œë¦¬í”„íŠ¸ ë°©ì§€
- ì„±ëŠ¥/ì—ëŸ¬ ë¡œê¹… ë³´ê°• ë° /docs ìŠ¤í‚¤ë§ˆ ì ê²€ ë£¨í‹´í™”

---

## [2025-08-11] ë³€ê²½ ìš”ì•½/ê²€ì¦/ë‹¤ìŒ ë‹¨ê³„ (ì´ˆëŒ€ì½”ë“œ/RBAC/Alembic)

ë³€ê²½ ìš”ì•½
- InviteCode ìŠ¤í‚¤ë§ˆ ì¼ì›í™”: expires_at, max_uses(None=ë¬´ì œí•œ), used_count(ê¸°ë³¸ 0), created_by í•„ë“œ ì •ì‹í™”. ì„œë¹„ìŠ¤/ë¦¬í¬ì§€í† ë¦¬/ë¼ìš°í„°ê°€ None=ë¬´ì œí•œ ê·œì¹™ìœ¼ë¡œ ë™ì‘í•˜ë„ë¡ í†µì¼.
- RBAC ë“±ê¸‰ ê°€ë“œ: require_min_rank ì˜ì¡´ì„± ì¶”ê°€ ë° ë°ëª¨ ë¼ìš°í„° /api/rbac/premium, /api/rbac/vip ë“±ë¡.
- Alembic ë³´ê°•: 20250811_add_invite_codes ë¦¬ë¹„ì „ì„ idempotent ì—…ê·¸ë ˆì´ë“œë¡œ êµ¬í˜„. ë ˆê±°ì‹œ current_uses â†’ used_count ë°±í•„ í›„ ë“œë¡­ ì‹œë„, created_by FK(users.id) ì¡°ê±´ë¶€ ìƒì„±, ë‹¨ì¼ head ìœ ì§€.

ê²€ì¦ ê²°ê³¼
- Pytest: auth/refresh, invite signup/login/me, ë½ì•„ì›ƒ/ë³„ì¹­, invite validate 5ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤ í¬í•¨ 12 passed (ê²½ê³  28: Pydantic v2/regex).
- OpenAPI: ì»¨í…Œì´ë„ˆ ë‚´ë¶€ `python -m app.export_openapi` ì„±ê³µ, current_openapi.json ê°±ì‹ . /api/invite/validate, /api/rbac/* ë…¸ì¶œ í™•ì¸.
- ìŠ¤ëª¨í¬: /docs 200, /health 200. Invite validateì—ì„œ ë¬´ì œí•œ ì½”ë“œ remaining_uses=null ë°˜í™˜ í™•ì¸.

ë‹¤ìŒ ë‹¨ê³„
- ìš´ì˜ DB ë°˜ì˜: ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ `alembic upgrade head` ì‹¤í–‰ í›„ `alembic heads`ë¡œ ë‹¨ì¼ head í™•ì¸. í•„ìš” ì‹œ merge ë¦¬ë¹„ì „ìœ¼ë¡œ í†µí•©.
- ê²½ê³  ì •ë¦¬: Pydantic ConfigDict ì „í™˜, FastAPI Query regexâ†’pattern êµì²´.
- VS Code íƒœìŠ¤í¬ ë³´ì •: repo ë£¨íŠ¸ íƒœìŠ¤í¬ê°€ ì‹¤íŒ¨í•˜ëŠ” ê²½ìš° backend CWDì—ì„œ `python -m pytest`ë¡œ ì‹¤í–‰í•˜ë„ë¡ íƒœìŠ¤í¬ ì¶”ê°€/êµì²´.

# [2025-08-12] ë³€ê²½ ìš”ì•½/ê²€ì¦/ë‹¤ìŒ ë‹¨ê³„ (API ë¬¸ì„œ í†µí•©)

ë³€ê²½ ìš”ì•½
- API ë§µí•‘ ë¬¸ì„œ ë‹¨ì¼í™”: `API_MAPPING.md`ë¡œ í†µí•©, `API_MAPPING_UPDATED.md` ì œê±° ëŒ€ìƒ ì§€ì •(ì¤‘ë³µ ë°©ì§€)
- ì¸ì¦ ë¼ìš°íŒ… í‘œì¤€: `/api/auth/*` ì¼ì›í™”, ë ˆê±°ì‹œ `/auth/register`ëŠ” Deprecatedë¡œ ë¬¸ì„œí™”

ê²€ì¦ ê²°ê³¼
- ë¦¬í¬ì§€í† ë¦¬ ë£¨íŠ¸ì—ì„œ ì¤‘ë³µ íŒŒì¼ ì ê²€: `API_MAPPING.md`ë§Œ ìœ ì§€ í™•ì¸ í•„ìš”
- OpenAPIëŠ” ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì¬ìˆ˜ì¶œ ì˜ˆì •: `python -m app.export_openapi`

ë‹¤ìŒ ë‹¨ê³„
- ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ OpenAPI ìŠ¤í‚¤ë§ˆ ì¬ìƒì„± í›„ `/docs` ìŠ¤ëª¨í¬ í™•ì¸
- Alembic heads ë‹¨ì¼ í™•ì¸, í…ŒìŠ¤íŠ¸ ìŠ¤ëª¨í¬(ì¸ì¦/ìœ ì €/ê²Œì„) 401â†’ë¡œê·¸ì¸â†’200 ì‹œë‚˜ë¦¬ì˜¤ ì ê²€

## [2025-08-12] ë³€ê²½ ìš”ì•½/ê²€ì¦/ë‹¤ìŒ ë‹¨ê³„ (Pydantic ê²½ê³  ì •ë¦¬)

ë³€ê²½ ìš”ì•½
- Pydantic v2 ê²½ê³  í•´ê²°: `Field "model_name" has conflict with protected namespace`
- ìˆ˜ì •: `cc-webapp/backend/app/schemas/chat_schemas.py`ì˜ AIAssistantCreate/AIAssistantResponseì—
	`model_config = ConfigDict(protected_namespaces=())` ì¶”ê°€, ì‘ë‹µ ëª¨ë¸ì€ `from_attributes=True` í¬í•¨

ê²€ì¦ ê²°ê³¼
- ë°±ì—”ë“œ ì¬ì‹œì‘ í›„ `docker logs cc_backend_local --tail=200`ì—ì„œ ë™ì¼ ê²½ê³  ë¯¸ë°œìƒ í™•ì¸
- `/docs` ì •ìƒ ë…¸ì¶œ, OpenAPI ìŠ¤í‚¤ë§ˆ ë¡œë“œ ì„±ê³µ

ë‹¤ìŒ ë‹¨ê³„
- ë‚¨ì€ v2 ê²½ê³ (ì˜ˆ: regexâ†’pattern, deprecated import) ìˆœì°¨ ì •ë¦¬
- ë³€ê²½ ì‚¬í•­ì„ ë°˜ì˜í•´ OpenAPI ì¬ìˆ˜ì¶œ: `python -m app.export_openapi`

