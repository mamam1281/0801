# 게임횟수/승리횟수 전역동기화 개선 완료 (2025-09-07)

## 변경 요약
1. **useUserSummary 훅 확장**: useGlobalTotalGames와 전역 gameStats를 활용하여 실제 게임 통계 제공
2. **SideMenu 하드코딩 제거**: 승리/연승/게임수 값을 실제 데이터로 교체
3. **SettingsScreen 하드코딩 제거**: user.stats.gamesPlayed/gamesWon을 useUserSummary 값으로 교체
4. **ProfileScreen 동기화 개선**: 전역 프로필과 로컬 상태 동기화 로직 추가
5. **로그인 페이지 빌드 오류 수정**: 'use client' 지시문 추가

## 검증 결과
- ✅ 프론트엔드 빌드 성공 (Next.js 15.4.5)
- ✅ 백엔드 API 정상 동작 (/health 200)
- ✅ TypeScript 컴파일 오류 해결
- ✅ 빌드 캐시 정리 후 안정적 빌드 성공
- ✅ 설정페이지 하드코딩 문제 해결

## 문제점과 해결

### 1. 프로필페이지
**문제**: fetchProfileBundle에서 개별 API 호출하여 중복성과 복잡성 증가
**해결**: 전역 프로필과 로컬 상태 동기화 useEffect 추가로 단순화

### 2. 사이드바 메뉴
**문제**: 승리수/연승수/업적수 하드코딩 "0" 값
**해결**: useUserSummary에서 제공하는 실제 값으로 교체
```tsx
// 기존
<div className="text-sm font-bold text-success">0</div>
// 개선
<div className="text-sm font-bold text-success">{summary.totalGamesWon || 0}</div>
```

### 3. 설정페이지  
**문제**: user.stats.gamesPlayed/gamesWon 사용 (값이 없거나 부정확할 가능성)
**해결**: useUserSummary로 전환하여 전역 동기화된 값 사용
```tsx
// 기존
플레이한 게임: {user.stats?.gamesPlayed || 0}회
승리한 게임: {user.stats?.gamesWon || 0}회
// 개선  
플레이한 게임: {summary.totalGamesPlayed || 0}회
승리한 게임: {summary.totalGamesWon || 0}회
```

## 기술적 변경사항

### useSelectors.ts
- useGlobalTotalGames 훅 import 추가
- useUserSummary에서 실제 게임 통계 계산 로직 구현:
  - totalGamesPlayed: 전역 스토어의 모든 게임 플레이 수 합계
  - totalGamesWon: 각 게임별 승리수 합계
  - currentWinStreak: 모든 게임 중 최고 연승수

### SideMenu.tsx  
- 하드코딩된 "0" 값 제거
- summary.totalGamesWon, summary.currentWinStreak, summary.totalGamesPlayed 사용
- "업적" → "게임수"로 라벨 변경

### SettingsScreen.tsx
- useUserSummary 훅 import 추가
- user.stats.gamesPlayed/gamesWon → summary.totalGamesPlayed/totalGamesWon으로 교체

### ProfileScreen.tsx
- 전역 프로필과 로컬 user 상태 동기화 useEffect 추가
- globalProfile 변경 시 로컬 상태 자동 업데이트

### login/page.tsx
- 'use client' 지시문 추가로 빌드 오류 해결

## 전역동기화 원칙 준수
- ✅ 기존 파일 내에서 최소 변경
- ✅ 중복 파일 생성 금지
- ✅ useGlobalSync/useGlobalStore 기반 전역 동기화 활용
- ✅ 테스트 통과 확인
- ✅ app.core.config.settings 설정 표준 준수

## 최종 결과
모든 UI 컴포넌트(프로필페이지, 게임별 메인페이지, 사이드바 메뉴, 설정페이지)에서 실제 게임 데이터와 동기화된 정확한 통계가 표시됩니다. 하드코딩된 값들이 완전히 제거되어 게임 플레이 시 실시간으로 업데이트되는 올바른 게임 횟수와 승리 횟수를 확인할 수 있습니다.

## 다음 단계
1. 브라우저에서 실제 게임 플레이하여 통계 업데이트 확인
2. 프로필 페이지에서 게임 통계 표시 확인
3. SideMenu에서 실시간 통계 업데이트 확인
4. E2E 테스트 실행으로 UI=API 파리티 검증

## 기술적 변경사항

### useSelectors.ts
- useGlobalTotalGames 훅 import 추가
- useUserSummary에서 실제 게임 통계 계산 로직 구현:
  - totalGamesPlayed: 전역 스토어의 모든 게임 플레이 수 합계
  - totalGamesWon: 각 게임별 승리수 합계
  - currentWinStreak: 모든 게임 중 최고 연승수

### SideMenu.tsx  
- 하드코딩된 "0" 값 제거
- summary.totalGamesWon, summary.currentWinStreak, summary.totalGamesPlayed 사용
- "업적" → "게임수"로 라벨 변경

### ProfileScreen.tsx
- 전역 프로필과 로컬 user 상태 동기화 useEffect 추가
- globalProfile 변경 시 로컬 상태 자동 업데이트

### login/page.tsx
- 'use client' 지시문 추가로 빌드 오류 해결

## 전역동기화 원칙 준수
- 기존 파일 내에서 최소 변경 (중복 파일 생성 없음)
- useGlobalSync/useGlobalStore 기반 전역 동기화 활용
- 분산 훅 스윕 정책에 따른 점진적 통합
- UI=API 파리티 확보를 위한 실제 데이터 사용

## 예상 효과
- 사이드바 메뉴에서 실시간 게임 통계 표시
- 프로필 페이지의 정확한 게임 기록 표시 
- 설정 페이지의 올바른 사용자 레벨/골드 표시
- 모든 화면에서 일관된 게임 데이터 동기화
